<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Hijacking on Hacking Blog</title><link>https://hack.com.cy/tags/hijacking/</link><description>Recent content in Hijacking on Hacking Blog</description><generator>Hugo</generator><language>en</language><lastBuildDate>Thu, 01 Jan 2026 02:13:14 +0200</lastBuildDate><atom:link href="https://hack.com.cy/tags/hijacking/index.xml" rel="self" type="application/rss+xml"/><item><title>Abusing Schedule Tasks</title><link>https://hack.com.cy/notes/privilege-escalation/windows/tasks/tasks/</link><pubDate>Fri, 08 Aug 2025 00:00:00 +0000</pubDate><guid>https://hack.com.cy/notes/privilege-escalation/windows/tasks/tasks/</guid><description>&lt;h1 id="enumerating-scheduled-tasks-on-windows">Enumerating Scheduled Tasks on Windows&lt;/h1>
&lt;h2 id="understanding-scheduled-tasks">Understanding Scheduled Tasks&lt;/h2>
&lt;p>Scheduled tasks in Windows allow the execution of scripts, programs, or commands at specific times or events. When enumerating scheduled tasks, it is essential to consider the following:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-mysql" data-lang="mysql">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Prerequisites
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">As&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">which&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">user&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nf">account&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">principal&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">does&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">this&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">task&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">get&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">executed&lt;/span>&lt;span class="o">?&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">What&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">triggers&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">are&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">specified&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">for&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">the&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">task&lt;/span>&lt;span class="o">?&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">What&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">actions&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">are&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">executed&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">when&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">one&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">or&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">more&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">of&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">these&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">triggers&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">are&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">met&lt;/span>&lt;span class="o">?&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="commands-for-enumerating-scheduled-tasks">Commands for Enumerating Scheduled Tasks&lt;/h2>
&lt;h3 id="querying-scheduled-tasks">Querying Scheduled Tasks&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-cmd" data-lang="cmd">&lt;span class="line">&lt;span class="cl"># Basic query of scheduled tasks with detailed information
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">schtasks /query /fo LIST /v
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"># Filter scheduled tasks by task name
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">schtasks /query /fo LIST &lt;span class="mi">2&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>nul &lt;span class="p">|&lt;/span> findstr TaskName
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"># Export scheduled tasks to a file and filter by specific details
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">schtasks /query /fo LIST /v &lt;span class="p">&amp;gt;&lt;/span> schtasks.txt; cat schtasks.txt &lt;span class="p">|&lt;/span> findstr &lt;span class="s2">&amp;#34;SYSTEM\|Task To Run&amp;#34;&lt;/span> &lt;span class="p">|&lt;/span> findstr -B 1 SYSTEM
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"># Filter scheduled tasks by specific fields of interest
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">schtasks /query /fo LIST /v &lt;span class="p">|&lt;/span> findstr /B /C:&lt;span class="s2">&amp;#34;Folder&amp;#34;&lt;/span> /C:&lt;span class="s2">&amp;#34;TaskName&amp;#34;&lt;/span> /C:&lt;span class="s2">&amp;#34;Run As User&amp;#34;&lt;/span> /C:&lt;span class="s2">&amp;#34;Schedule&amp;#34;&lt;/span> /C:&lt;span class="s2">&amp;#34;Scheduled Task State&amp;#34;&lt;/span> /C:&lt;span class="s2">&amp;#34;Schedule Type&amp;#34;&lt;/span> /C:&lt;span class="s2">&amp;#34;Repeat: Every&amp;#34;&lt;/span> /C:&lt;span class="s2">&amp;#34;Comment&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="using-powershell">Using PowerShell&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-powershell" data-lang="powershell">&lt;span class="line">&lt;span class="cl">&lt;span class="c"># List scheduled tasks excluding Microsoft default tasks&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">Get-ScheduledTask&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="nb">where &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="nv">$_&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="py">TaskPath&lt;/span> &lt;span class="o">-notlike&lt;/span> &lt;span class="s2">&amp;#34;\Microsoft*&amp;#34;&lt;/span>&lt;span class="p">}&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="nb">ft &lt;/span>&lt;span class="n">TaskName&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">TaskPath&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">State&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="key-attributes-to-analyze">Key Attributes to Analyze&lt;/h2>
&lt;ul>
&lt;li>&lt;strong>Author&lt;/strong>: Who created the task?&lt;/li>
&lt;li>&lt;strong>TaskName&lt;/strong>: The name of the scheduled task.&lt;/li>
&lt;li>&lt;strong>Task To Run&lt;/strong>: The executable or script that the task triggers.&lt;/li>
&lt;li>&lt;strong>Next Run Time&lt;/strong>: When the task is scheduled to run next.&lt;/li>
&lt;/ul>
&lt;h2 id="note">Note&lt;/h2>
&lt;p>Once you have enumerated scheduled tasks, investigate any anomalies or tasks that execute with high privileges (e.g., SYSTEM).&lt;/p></description></item><item><title>Abusing Windows Services</title><link>https://hack.com.cy/notes/privilege-escalation/windows/services/services/</link><pubDate>Fri, 08 Aug 2025 00:00:00 +0000</pubDate><guid>https://hack.com.cy/notes/privilege-escalation/windows/services/services/</guid><description>&lt;h1 id="services---unquoted-service-path---hijacking">Services - Unquoted Service Path - Hijacking&lt;/h1>
&lt;h2 id="searching-for-running--stopped-services">Searching for Running &amp;amp; Stopped Services&lt;/h2>
&lt;p>When working with Windows services, identifying running and stopped services is crucial for discovering misconfigurations that could lead to privilege escalation.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-powershell" data-lang="powershell">&lt;span class="line">&lt;span class="cl">&lt;span class="c"># When using a network logon such as WinRM or a bind shell, Get-CimInstance and Get-Service may result in &amp;#34;permission denied&amp;#34;.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># See All Running Services&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">Get-CimInstance&lt;/span> &lt;span class="n">-ClassName&lt;/span> &lt;span class="n">win32_service&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="nb">Select &lt;/span>&lt;span class="n">Name&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">State&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">PathName&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="nb">Where-Object&lt;/span> &lt;span class="p">{&lt;/span>&lt;span class="nv">$_&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="py">State&lt;/span> &lt;span class="o">-like&lt;/span> &lt;span class="s1">&amp;#39;Running&amp;#39;&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># Discard Services that start from &amp;#34;C:/Windows&amp;#34; to filter out system services&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">Get-CimInstance&lt;/span> &lt;span class="n">-ClassName&lt;/span> &lt;span class="n">win32_service&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="nb">Select &lt;/span>&lt;span class="n">Name&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">State&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">PathName&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="nb">Where-Object&lt;/span> &lt;span class="p">{&lt;/span>&lt;span class="nv">$_&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="py">State&lt;/span> &lt;span class="o">-like&lt;/span> &lt;span class="s1">&amp;#39;Running&amp;#39;&lt;/span>&lt;span class="p">}&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="n">findstr&lt;/span> &lt;span class="p">/&lt;/span>&lt;span class="n">i&lt;/span> &lt;span class="p">/&lt;/span>&lt;span class="n">v&lt;/span> &lt;span class="s2">&amp;#34;C:\Windows&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># Get Running Services using SC command&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">sc &lt;/span>&lt;span class="n">query&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="n">findstr&lt;/span> &lt;span class="n">SERVICE_NAME&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># Get both STOPPED and RUNNING Services&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">Get-CimInstance&lt;/span> &lt;span class="n">-ClassName&lt;/span> &lt;span class="n">win32_service&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="nb">Select &lt;/span>&lt;span class="n">Name&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">State&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">PathName&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="searching-for-unquoted-service-paths">Searching for Unquoted Service Paths&lt;/h2>
&lt;p>Unquoted service paths are a common misconfiguration where a service executable path contains spaces but lacks quotation marks. This allows an attacker to place a malicious executable in an earlier part of the path, leading to privilege escalation.&lt;/p></description></item></channel></rss>