<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Unquoted Service Path on Hacking Blog</title><link>https://hack.com.cy/tags/unquoted-service-path/</link><description>Recent content in Unquoted Service Path on Hacking Blog</description><generator>Hugo</generator><language>en</language><lastBuildDate>Thu, 01 Jan 2026 02:13:14 +0200</lastBuildDate><atom:link href="https://hack.com.cy/tags/unquoted-service-path/index.xml" rel="self" type="application/rss+xml"/><item><title>Abusing Windows Services</title><link>https://hack.com.cy/notes/privilege-escalation/windows/services/services/</link><pubDate>Fri, 08 Aug 2025 00:00:00 +0000</pubDate><guid>https://hack.com.cy/notes/privilege-escalation/windows/services/services/</guid><description>&lt;h1 id="services---unquoted-service-path---hijacking">Services - Unquoted Service Path - Hijacking&lt;/h1>
&lt;h2 id="searching-for-running--stopped-services">Searching for Running &amp;amp; Stopped Services&lt;/h2>
&lt;p>When working with Windows services, identifying running and stopped services is crucial for discovering misconfigurations that could lead to privilege escalation.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-powershell" data-lang="powershell">&lt;span class="line">&lt;span class="cl">&lt;span class="c"># When using a network logon such as WinRM or a bind shell, Get-CimInstance and Get-Service may result in &amp;#34;permission denied&amp;#34;.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># See All Running Services&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">Get-CimInstance&lt;/span> &lt;span class="n">-ClassName&lt;/span> &lt;span class="n">win32_service&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="nb">Select &lt;/span>&lt;span class="n">Name&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">State&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">PathName&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="nb">Where-Object&lt;/span> &lt;span class="p">{&lt;/span>&lt;span class="nv">$_&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="py">State&lt;/span> &lt;span class="o">-like&lt;/span> &lt;span class="s1">&amp;#39;Running&amp;#39;&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># Discard Services that start from &amp;#34;C:/Windows&amp;#34; to filter out system services&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">Get-CimInstance&lt;/span> &lt;span class="n">-ClassName&lt;/span> &lt;span class="n">win32_service&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="nb">Select &lt;/span>&lt;span class="n">Name&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">State&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">PathName&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="nb">Where-Object&lt;/span> &lt;span class="p">{&lt;/span>&lt;span class="nv">$_&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="py">State&lt;/span> &lt;span class="o">-like&lt;/span> &lt;span class="s1">&amp;#39;Running&amp;#39;&lt;/span>&lt;span class="p">}&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="n">findstr&lt;/span> &lt;span class="p">/&lt;/span>&lt;span class="n">i&lt;/span> &lt;span class="p">/&lt;/span>&lt;span class="n">v&lt;/span> &lt;span class="s2">&amp;#34;C:\Windows&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># Get Running Services using SC command&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">sc &lt;/span>&lt;span class="n">query&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="n">findstr&lt;/span> &lt;span class="n">SERVICE_NAME&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># Get both STOPPED and RUNNING Services&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">Get-CimInstance&lt;/span> &lt;span class="n">-ClassName&lt;/span> &lt;span class="n">win32_service&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="nb">Select &lt;/span>&lt;span class="n">Name&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">State&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">PathName&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="searching-for-unquoted-service-paths">Searching for Unquoted Service Paths&lt;/h2>
&lt;p>Unquoted service paths are a common misconfiguration where a service executable path contains spaces but lacks quotation marks. This allows an attacker to place a malicious executable in an earlier part of the path, leading to privilege escalation.&lt;/p></description></item></channel></rss>